<!DOCTYPE html>






  


<html class="theme-next mist use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.2.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.2.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/logo.jpg?v=6.2.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.2.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.2.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '6.2.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="漫漫长路，伴你同行">
<meta property="og:type" content="website">
<meta property="og:title" content="qin12的学习博客">
<meta property="og:url" content="http://yoursite.com/page/4/index.html">
<meta property="og:site_name" content="qin12的学习博客">
<meta property="og:description" content="漫漫长路，伴你同行">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="qin12的学习博客">
<meta name="twitter:description" content="漫漫长路，伴你同行">



  <link rel="alternate" href="/atom.xml" title="qin12的学习博客" type="application/atom+xml" />




  <link rel="canonical" href="http://yoursite.com/page/4/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>qin12的学习博客</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">qin12的学习博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">只为成功找方法，不为失败找借口！</p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>




<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-photo">
    <a href="/photo/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-photo"></i> <br />摄影</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-music">
    <a href="/music/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-music"></i> <br />音乐</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />关于</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/20/HttpServletResponse常见应用——生成验证码/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qgx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qin12的学习博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/20/HttpServletResponse常见应用——生成验证码/" itemprop="url">
                  javaweb (七)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-07-20 12:10:37" itemprop="dateCreated datePublished" datetime="2018-07-20T12:10:37+08:00">2018-07-20</time>
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/javaEE/" itemprop="url" rel="index"><span itemprop="name">javaEE</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="HttpServletResponse常见应用——生成验证码"><a href="#HttpServletResponse常见应用——生成验证码" class="headerlink" title="HttpServletResponse常见应用——生成验证码"></a>HttpServletResponse常见应用——生成验证码</h3><h4 id="生成随机图片用作验证码"><a href="#生成随机图片用作验证码" class="headerlink" title="生成随机图片用作验证码"></a>生成随机图片用作验证码</h4><p>生成图片主要用到了一个BufferedImage类，<br><img src="/img/BufferedImage.png" alt=""><br>生成随机图片范例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">package qgx.response.study;</span><br><span class="line">import javax.imageio.ImageIO;</span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.annotation.WebServlet;</span><br><span class="line">import javax.servlet.http.HttpServlet;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line">import java.awt.*;</span><br><span class="line">import java.awt.image.BufferedImage;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.util.Random;</span><br><span class="line">@WebServlet(name = &quot;ResponseDemo3&quot;)</span><br><span class="line">public class ResponseDemo3 extends HttpServlet &#123;</span><br><span class="line">    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">  doGet(request,response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">        response.setHeader(&quot;refresh&quot;, &quot;5&quot;);//设置refresh响应头控制浏览器每隔5秒钟刷新一次</span><br><span class="line">        //1.在内存中创建一张图片</span><br><span class="line">        BufferedImage image = new BufferedImage(80, 20, BufferedImage.TYPE_INT_RGB);</span><br><span class="line">        //2.得到图片</span><br><span class="line">        Graphics g = (Graphics)image.getGraphics();</span><br><span class="line">        g.setColor(Color.WHITE);//设置图片的背景色</span><br><span class="line">        g.fillRect(0, 0, 80, 20);//填充背景色</span><br><span class="line">        //3.向图片上写数据</span><br><span class="line">        g.setColor(Color.BLUE);//设置图片上字体的颜色</span><br><span class="line">        g.setFont(new Font(null, Font.BOLD, 20));</span><br><span class="line">        g.drawString(makeNum(), 0, 20);</span><br><span class="line">        //4.设置响应头控制浏览器浏览器以图片的方式打开</span><br><span class="line">        response.setContentType(&quot;image/jpeg&quot;);//等同于response.setHeader(&quot;Content-Type&quot;, &quot;image/jpeg&quot;);</span><br><span class="line">        //5.设置响应头控制浏览器不缓存图片数据</span><br><span class="line">        response.setDateHeader(&quot;expries&quot;, -1);</span><br><span class="line">        response.setHeader(&quot;Cache-Control&quot;, &quot;no-cache&quot;);</span><br><span class="line">        response.setHeader(&quot;Pragma&quot;, &quot;no-cache&quot;);</span><br><span class="line">        //6.将图片写给浏览器</span><br><span class="line">        ImageIO.write(image, &quot;jpg&quot;, response.getOutputStream());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private String makeNum() &#123;</span><br><span class="line">        Random random = new Random();</span><br><span class="line">        String num = random.nextInt(9999999)+&quot;&quot;;</span><br><span class="line">        StringBuffer sb = new StringBuffer();</span><br><span class="line">        for (int i = 0; i &lt; 7-num.length(); i++) &#123;</span><br><span class="line">            sb.append(&quot;0&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        num = sb.toString()+num;</span><br><span class="line">        return num;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><img src="/img/ResponseDemo3.jpg" alt=""></p>
<h3 id="HttpServletResponse常见应用——设置响应头控制浏览器的行为"><a href="#HttpServletResponse常见应用——设置响应头控制浏览器的行为" class="headerlink" title="HttpServletResponse常见应用——设置响应头控制浏览器的行为"></a>HttpServletResponse常见应用——设置响应头控制浏览器的行为</h3><h4 id="设置http响应头控制浏览器禁止缓存当前文档内容"><a href="#设置http响应头控制浏览器禁止缓存当前文档内容" class="headerlink" title="设置http响应头控制浏览器禁止缓存当前文档内容"></a>设置http响应头控制浏览器禁止缓存当前文档内容</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">response.setDateHeader(&quot;expries&quot;, -1);</span><br><span class="line">response.setHeader(&quot;Cache-Control&quot;, &quot;no-cache&quot;);</span><br><span class="line">response.setHeader(&quot;Pragma&quot;, &quot;no-cache&quot;);</span><br></pre></td></tr></table></figure>
<h4 id="设置http响应头控制浏览器定时刷新网页-refresh"><a href="#设置http响应头控制浏览器定时刷新网页-refresh" class="headerlink" title="设置http响应头控制浏览器定时刷新网页(refresh)"></a>设置http响应头控制浏览器定时刷新网页(refresh)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.setHeader(&quot;refresh&quot;, &quot;5&quot;);//设置refresh响应头控制浏览器每隔5秒钟刷新一次</span><br></pre></td></tr></table></figure>
<h4 id="通过response实现请求重定向"><a href="#通过response实现请求重定向" class="headerlink" title="通过response实现请求重定向"></a>通过response实现请求重定向</h4><ul>
<li>请求重定向指：一个web资源收到客户端请求后，通知客户端去访问另外一个web资源，这称之为请求重定向。</li>
<li>应用场景：用户登陆，用户首先访问登录页面，登录成功后，就会跳转到某个页面，这个过程就是一个请求重定向的过程</li>
<li>实现方式：response.sendRedirect(String location)，即调用response对象的sendRedirect方法实现请求重定向</li>
<li>sendRedirect内部的实现原理：使用response设置302状态码和设置location响应头实现重定向</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> response.sendRedirect(&quot;/index.jsp&quot;);</span><br><span class="line">1.调用sendRedirect方法实现请求重定向, sendRedirect方法内部调用了</span><br><span class="line">response.setHeader(&quot;Location&quot;, &quot;/index.jsp&quot;);</span><br><span class="line">response.setStatus(HttpServletResponse.SC_FOUND);//设置302状态码，等同于response.setStatus(302);</span><br></pre></td></tr></table></figure>
<h3 id="web工程中URL地址的推荐写法"><a href="#web工程中URL地址的推荐写法" class="headerlink" title="web工程中URL地址的推荐写法"></a>web工程中URL地址的推荐写法</h3><p>　在JavaWeb开发中，只要是写URL地址，那么建议最好以”/“开头，也就是使用绝对路径的方式，那么这个”/“到底代表什么呢？可以用如下的方式来记忆”/“：如果”/“是给服务器用的，则代表当前的web工程，如果”/“是给浏览器用的，则代表webapps目录。</p>
<h4 id="“-“代表当前web工程的常见应用场景"><a href="#“-“代表当前web工程的常见应用场景" class="headerlink" title="“/“代表当前web工程的常见应用场景"></a>“/“代表当前web工程的常见应用场景</h4><p>①.ServletContext.getRealPath(String path)获取资源的绝对路径<br> this.getServletContext().getRealPath(“/download/1.JPG”);</p>
<ul>
<li>ServletContext.getRealPath(“/download/1.JPG”)表示的就是读取web工程下的download文件夹中的1.JPG这个资源</li>
</ul>
<p>②.在服务器端forward到其他页面</p>
<p> this.getServletContext().getRequestDispatcher(“/index.jsp”).forward(request, response);</p>
<ul>
<li>forward 客户端请求某个web资源，服务器跳转到另外一个web资源，这个forward也是给服务器用的，<br>那么这个”/“就是给服务器用的，所以此时”/“代表的就是web工程</li>
</ul>
<p>③.使用include指令或者<a href="jsp:include" target="_blank" rel="noopener">jsp:include</a>标签引入页面<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:include page=&quot;/jspfragments/demo.jsp&quot; /&gt;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>此时”/“代表的都是web工程。</li>
</ul>
<h4 id="“-“代表webapps目录的常见应用场景"><a href="#“-“代表webapps目录的常见应用场景" class="headerlink" title="“/“代表webapps目录的常见应用场景"></a>“/“代表webapps目录的常见应用场景</h4><p>①.使用sendRedirect实现请求重定向<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.sendRedirect(&quot;/Servlet_Study/index.jsp&quot;);</span><br></pre></td></tr></table></figure></p>
<ul>
<li>服务器发送一个URL地址给浏览器，浏览器拿到URL地址之后，再去请求服务器，所以这个”/“是给浏览器使用的，此时”/“代表的就是webapps目录，”/Servlet_Study/index.jsp”这个地址指的就是”webapps\Servlet_Study\index.jsp”</li>
<li>response.sendRedirect(“/项目名称/文件夹目录/页面”);这种写法是将项目名称写死在程序中的做法，不灵活，万一哪天项目名称变了，此时就得改程序，所以推荐使用下面的灵活写法：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.sendRedirect(request.getContextPath()+&quot;/index.jsp&quot;);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>②.使用超链接跳转<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;/Servlet_Study/index.jsp&quot;&gt;跳转到首页&lt;/a&gt;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>这是客户端浏览器使用的超链接跳转，这个”/“是给浏览器使用的，此时”/“代表的就是webapps目录。</li>
<li>使用超链接访问web资源，绝对路径的写法推荐使用下面的写法改进：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;$&#123;pageContext.request.contextPath&#125;/index.jsp&quot;&gt;跳转到首页&lt;/a&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>③.Form表单提交<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=&quot;/Servlet_Study/servlet/CheckServlet&quot; method=&quot;post&quot;&gt;    </span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line"> &lt;/form&gt;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>这是客户端浏览器将form表单提交到服务器，所以这个”/“是给浏览器使用的，此时”/“代表的就是webapps目录。<br>对于form表单提交中action属性绝对路径的写法，也推荐使用如下的方式改进：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=&quot;$&#123;pageContext.request.contextPath&#125;/servlet/CheckServlet&quot; method=&quot;post&quot;&gt;</span><br><span class="line">         &lt;input type=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line"> &lt;/form&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>④.js脚本和css样式文件的引用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;%--使用绝对路径的方式引用js脚本--%&gt;</span><br><span class="line">  &lt;script type=&quot;text/javascript&quot; src=&quot;$&#123;pageContext.request.contextPath&#125;/js/index.js&quot;&gt;&lt;/script&gt;</span><br><span class="line"> &lt;%--$&#123;pageContext.request.contextPath&#125;与request.getContextPath()写法是得到的效果是一样的--%&gt;</span><br><span class="line">  &lt;script type=&quot;text/javascript&quot; src=&quot;&lt;%=request.getContextPath()%&gt;/js/login.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">  &lt;%--使用绝对路径的方式引用css样式--%&gt;</span><br><span class="line">  &lt;link rel=&quot;stylesheet&quot; href=&quot;$&#123;pageContext.request.contextPath&#125;/css/index.css&quot; type=&quot;text/css&quot;/&gt;</span><br></pre></td></tr></table></figure>
<h3 id="response细节问题"><a href="#response细节问题" class="headerlink" title="response细节问题"></a>response细节问题</h3><ul>
<li>getOutputStream和getWriter方法分别用于得到输出二进制数据、输出文本数据的ServletOuputStream、Printwriter对象。</li>
<li>getOutputStream和getWriter这两个方法互相排斥，调用了其中的任何一个方法后，就不能再调用另一方法。  </li>
<li>Servlet程序向ServletOutputStream或PrintWriter对象中写入的数据将被Servlet引擎从response里面获取，Servlet引擎将这些数据当作响应消息的正文，然后再与响应状态行和各响应头组合后输出到客户端。 </li>
<li>Serlvet的service方法结束后，Servlet引擎将检查getWriter或getOutputStream方法返回的输出流对象是否已经调用过close方法，如果没有，Servlet引擎将调用close方法关闭该输出流对象。</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/20/深入理解Tomcat系列之一：系统架构/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qgx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qin12的学习博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/20/深入理解Tomcat系列之一：系统架构/" itemprop="url">
                  深入理解Tomcat系列之一
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-07-20 12:10:37" itemprop="dateCreated datePublished" datetime="2018-07-20T12:10:37+08:00">2018-07-20</time>
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/javaEE/" itemprop="url" rel="index"><span itemprop="name">javaEE</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="深入理解Tomcat系列之一：系统架构"><a href="#深入理解Tomcat系列之一：系统架构" class="headerlink" title="深入理解Tomcat系列之一：系统架构"></a>深入理解Tomcat系列之一：系统架构</h2><h3 id="Tomcat的系统架构"><a href="#Tomcat的系统架构" class="headerlink" title="Tomcat的系统架构"></a>Tomcat的系统架构</h3><p><img src="/img/tomcat_architect.jpg" alt=""><br>首先我们从一个宏观的角度来看一下Tomcat的系统的架构：从这张图中可以看到，Tomcat的核心组件就两个Connector和Container（后面还有详细说明），一个Connector+一个Container构成一个Service，Service就是对外提供服务的组件，有了Service组件Tomcat就可以对外提供服务了，但是光有服务还不行，还得有环境让你提供服务才行，所以最外层的Server就为Service提供了生存的土壤。那么这些个组件到底是干嘛用的呢？Connector是一个连接器，主要负责接收请求并把请求交给Container，Container就是一个容器，主要装的是具体处理请求的组件。Service主要是为了关联Container与Connector，一个单独的Container或者一个单独的Connector都不能完整处理一个请求，只有两个结合在一起才能完成一个请求的处理。Server这是负责管理Service集合，从图中我们看到一个Tomcat可以提供多种服务，那么这些Serice就是由Server来管理的，具体的工作包括：对外提供一个接口访问Service，对内维护Service集合，维护Service集合又包括管理Service的生命周期、寻找一个请求的Service、结束一个Service等。以上就是对Tomcat的核心组件的简要说明，下面我们详细看看每一个组件的执行流程：</p>
<h3 id="Server"><a href="#Server" class="headerlink" title="Server"></a>Server</h3><p>上面说Server是管理Service接口的，Server是Tomcat的顶级容器，是一个接口，Server接口的标准实现类是StandardServer类，在Server接口中有许多方法，我们重点关注两个方法：addService()和findService(String)。我们先来看看Server接口的全貌：<br><img src="/img/Server2.jpg" alt=""><br>接着看看addService()和findService(String)的实现代码：<br>代码清单1-1:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Add a new Service to the set of defined Services.</span><br><span class="line"> *</span><br><span class="line"> * @param service The Service to be added</span><br><span class="line"> */</span><br><span class="line">@Override</span><br><span class="line">public void addService(Service service) &#123;</span><br><span class="line"></span><br><span class="line">    service.setServer(this);</span><br><span class="line"></span><br><span class="line">    synchronized (services) &#123;</span><br><span class="line">        Service results[] = new Service[services.length + 1];</span><br><span class="line">        System.arraycopy(services, 0, results, 0, services.length);</span><br><span class="line">        results[services.length] = service;</span><br><span class="line">        services = results;</span><br><span class="line"></span><br><span class="line">        if (getState().isAvailable()) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                service.start();</span><br><span class="line">            &#125; catch (LifecycleException e) &#123;</span><br><span class="line">                // Ignore</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // Report this property change to interested listeners</span><br><span class="line">        support.firePropertyChange(&quot;service&quot;, null, service);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>可以看到，Server使用一个数组来管理Service的，每添加一个Service就把原来的Service拷贝到一个新的数组中，再把新的Service放入Service数组中。所以Server与Service是关联在一起的，那么后面的getState().isAvailable()是干嘛的呢？判断状态是否无效，从而决定是否执行service方法。这里说到了状态，就不得不说Tomcat管理各组件生命周期的Lifecycle接口了：</p>
<h4 id="Lifecycle接口"><a href="#Lifecycle接口" class="headerlink" title="Lifecycle接口"></a>Lifecycle接口</h4><p>Tomcat中的组件都交给这个接口管理，但是具体组件的生命周期是由包含组件的父容器来管理的，Tomcat中顶级容器管理着Service的生命周期，Service容器又是Connector和Container的父容器，所以这两个组件的生命周期是由Service管理的，Container也有子容器，所以管理着这些子容器的生命周期。这样，只要所有组件都实现了Lifecycle接口，从顶层容器Server开始，就可以控制所有容器的生命周期了。Lifecycle接口中定义了很多状态，在api中详细说明了调用不同方法后的状态转变，同时定义了不同的方法，这些方法在执行后状态会发生相应的改变，在Lifecycle接口中定义了如下方法：<br><img src="/img/Lifecycle.jpg" alt=""><br>在StandServer中实现了startInernal()方法，就是循环启动StandServer管理的Service的过程，Tomcat的Service都实现了Lifecycle接口，所以被管理的Service都将被通知到，从而执行start()方法，startIntenal()方法是这样的：<br>代码清单1-2：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Start nested components (&#123;@link Service&#125;s) and implement the requirements</span><br><span class="line"> * of &#123;@link org.apache.catalina.util.LifecycleBase#startInternal()&#125;.</span><br><span class="line"> *</span><br><span class="line"> * @exception LifecycleException if this component detects a fatal error</span><br><span class="line"> *  that prevents this component from being used</span><br><span class="line"> */</span><br><span class="line">@Override</span><br><span class="line">protected void startInternal() throws LifecycleException &#123;</span><br><span class="line"></span><br><span class="line">    fireLifecycleEvent(CONFIGURE_START_EVENT, null);</span><br><span class="line">    setState(LifecycleState.STARTING);</span><br><span class="line"></span><br><span class="line">    globalNamingResources.start();</span><br><span class="line"></span><br><span class="line">    // Start our defined Services</span><br><span class="line">    synchronized (services) &#123;</span><br><span class="line">        for (int i = 0; i &lt; services.length; i++) &#123;</span><br><span class="line">            services[i].start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>现在所有的Service就会收到通知继而执行start方法。如果一个Service不允许被使用将会抛出一个LifecycleException异常。</p>
<p>stopIntenal()会通知所有Service执行stop方法，具体处理流程与startIntenal()方法类似。这个执行过程涉及一个非常重要的设计模式，就是观察者模式。</p>
<p>现在我们已经能够知道了容器通过Lifecycle接口管理容器的生命周期，那么在父容器的状态改变具体是怎么样通知给子容器的呢？回到代码清单1-2，我们注意到有一个fireLifecycleEvent()方法，fireLifecycleEvent()的执行流程如下：</p>
<ul>
<li>调用LifecycleBase的fireLifecycleEvent(LifecycleListener listener)方法，LifecycleBase是一个抽象类，实现了Lifecycle接口</li>
<li>继续调用LifecycleSupport（是一个辅助完成对已经注册监听器的事件通知类，不可被继承，使用final)的fireLifecycleEvent(String type, Object data)方法</li>
<li>完成事件通知</li>
</ul>
<p>fireLifecycleEvent(String type, Object data)的方法如下：</p>
<p>代码清单1-3：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Notify all lifecycle event listeners that a particular event has</span><br><span class="line"> * occurred for this Container.  The default implementation performs</span><br><span class="line"> * this notification synchronously using the calling thread.</span><br><span class="line"> *</span><br><span class="line"> * @param type Event type</span><br><span class="line"> * @param data Event data</span><br><span class="line"> */</span><br><span class="line">public void fireLifecycleEvent(String type, Object data) &#123;</span><br><span class="line"></span><br><span class="line">    LifecycleEvent event = new LifecycleEvent(lifecycle, type, data);</span><br><span class="line">    LifecycleListener interested[] = listeners;</span><br><span class="line">    for (int i = 0; i &lt; interested.length; i++)</span><br><span class="line">        interested[i].lifecycleEvent(event);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>所以，具体事件的通知是由LifecycleListener接口的lifecycleEvent方法完成的，各实现类可以根据不同的情况实现不同的事件监听逻辑</p>
<h3 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h3><p>Service是具体提供服务的接口，一个Service包装了Connector和一个Container，在Tomcat中这点是如何实现的呢？Service是一个接口，其标准实现类是StandardService，下面是这两个类的鸟瞰图：<br><img src="/img/Service.jpg" alt=""><br><img src="/img/StandardService.jpg" alt=""><br>这里，我们只关心与Connector和Container最紧密的方法：setContainer()和addConnector()方法，先看一下setContainer()方法的源码：<br>代码清单2-1：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Set the &lt;code&gt;Container&lt;/code&gt; that handles requests for all</span><br><span class="line"> * &lt;code&gt;Connectors&lt;/code&gt; associated with this Service.</span><br><span class="line"> *</span><br><span class="line"> * @param container The new Container</span><br><span class="line"> */</span><br><span class="line">@Override</span><br><span class="line">public void setContainer(Container container) &#123;</span><br><span class="line"></span><br><span class="line">    Container oldContainer = this.container;</span><br><span class="line">    if ((oldContainer != null) &amp;&amp; (oldContainer instanceof Engine))</span><br><span class="line">        ((Engine) oldContainer).setService(null);</span><br><span class="line">    this.container = container;</span><br><span class="line">    if ((this.container != null) &amp;&amp; (this.container instanceof Engine))</span><br><span class="line">        ((Engine) this.container).setService(this);</span><br><span class="line">    if (getState().isAvailable() &amp;&amp; (this.container != null)) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            this.container.start();</span><br><span class="line">        &#125; catch (LifecycleException e) &#123;</span><br><span class="line">            // Ignore</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if (getState().isAvailable() &amp;&amp; (oldContainer != null)) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            oldContainer.stop();</span><br><span class="line">        &#125; catch (LifecycleException e) &#123;</span><br><span class="line">            // Ignore</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Report this property change to interested listeners</span><br><span class="line">    support.firePropertyChange(&quot;container&quot;, oldContainer, this.container);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>从代码中可以看到这个方法主要的任务是设置一个Container容器来处理一个或者多个Connector传送过来的请求。首先判断当前的Service是否已经关联了Container容器，如果已经关联了就去除这个关联关系。如果原来的Container容器已经启动了就终止其生命周期，结束运行并设置新的关联关系，这个新的Container容器开始新的生命周期。最后把这个过程通知给感兴趣的事件监听程序。</p>
<p>下面看看addConnector的方法：</p>
<p>代码清单2-2：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Add a new Connector to the set of defined Connectors, and associate it</span><br><span class="line"> * with this Service&apos;s Container.</span><br><span class="line"> *</span><br><span class="line"> * @param connector The Connector to be added</span><br><span class="line"> */</span><br><span class="line">@Override</span><br><span class="line">public void addConnector(Connector connector) &#123;</span><br><span class="line"></span><br><span class="line">    synchronized (connectors) &#123;</span><br><span class="line">        connector.setService(this);</span><br><span class="line">        Connector results[] = new Connector[connectors.length + 1];</span><br><span class="line">        System.arraycopy(connectors, 0, results, 0, connectors.length);</span><br><span class="line">        results[connectors.length] = connector;</span><br><span class="line">        connectors = results;</span><br><span class="line"></span><br><span class="line">        if (getState().isAvailable()) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                connector.start();</span><br><span class="line">            &#125; catch (LifecycleException e) &#123;</span><br><span class="line">                log.error(sm.getString(</span><br><span class="line">                        &quot;standardService.connector.startFailed&quot;,</span><br><span class="line">                        connector), e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // Report this property change to interested listeners</span><br><span class="line">        support.firePropertyChange(&quot;connector&quot;, null, connector);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>执行过程也比较清楚：用一个同步代码块包住connectors数组，首先设置connector与container和service的关联关系，然后让connector开始新的生命周期，最后通知感兴趣的事件监听程序。注意到Connector的管理和Server管理Service一样都使用了数组拷贝并把新的数组赋给当前的数组，从而间接实现了动态数组。之所以使用数组我想可能是出于性能的考虑吧。</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/20/Servlet 的线程安全问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qgx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qin12的学习博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/20/Servlet 的线程安全问题/" itemprop="url">
                  javaweb (二)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-07-20 12:10:37" itemprop="dateCreated datePublished" datetime="2018-07-20T12:10:37+08:00">2018-07-20</time>
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/javaEE/" itemprop="url" rel="index"><span itemprop="name">javaEE</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Servlet-的线程安全问题"><a href="#Servlet-的线程安全问题" class="headerlink" title="Servlet 的线程安全问题"></a>Servlet 的线程安全问题</h3><ul>
<li>当多个客户端并发访问同一个Servlet时，web服务器会为每一个客户端的访问请求创建一个线程，并在这个线程上调用Servlet的service方法，因此service方法内如果访问了同一个资源的话，就有可能引发线程安全问题。例如下面的代码：</li>
<li>不存在线程安全问题的代码：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.annotation.WebServlet;</span><br><span class="line">import javax.servlet.http.HttpServlet;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">@WebServlet(name = &quot;Servlet&quot;)</span><br><span class="line">public class ServletDemo3 extends HttpServlet &#123;</span><br><span class="line">    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">doGet(request,response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">/** * 当多线程并发访问这个方法里面的代码时，会存在线程安全问题吗</span><br><span class="line">  * i变量被多个线程并发访问，但是没有线程安全问题，因为i是doGet方法里面的局部变量，</span><br><span class="line">  * 当有多个线程并发访问doGet方法时，每一个线程里面都有自己的i变量，</span><br><span class="line">  * 各个线程操作的都是自己的i变量，所以不存在线程安全问题</span><br><span class="line">  * 多线程并发访问某一个方法的时候，如果在方法内部定义了一些资源(变量，集合等)</span><br><span class="line">  * 那么每一个线程都有这些东西，所以就不存在线程安全问题了</span><br><span class="line">  */</span><br><span class="line">        int i=1;</span><br><span class="line">        i++;        response.getWriter().write(i+&quot;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>存在线程安全问题的代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.annotation.WebServlet;</span><br><span class="line">import javax.servlet.http.HttpServlet;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">@WebServlet(name = &quot;ServletDemo4&quot;)</span><br><span class="line">public class ServletDemo4 extends HttpServlet &#123;</span><br><span class="line">    int i=1;</span><br><span class="line">    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">doGet(request,response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">        i++;</span><br><span class="line">        try &#123;</span><br><span class="line">             Thread.sleep(1000);</span><br><span class="line">            &#125; catch (InterruptedException e) &#123;</span><br><span class="line">             e.printStackTrace();</span><br><span class="line">            &#125;    response.getWriter().write(i+&quot;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>　把i定义成全局变量，当多个线程并发访问变量i时，就会存在线程安全问题了，如下图所示：同时开启两个浏览器模拟并发访问同一个Servlet，本来正常来说，第一个浏览器应该看到2，而第二个浏览器应该看到3的，结果两个浏览器都看到了3，这就不正常。<br>　线程安全问题只存在多个线程并发操作同一个资源的情况下，所以在编写Servlet的时候，如果并发访问某一个资源(变量，集合等)，就会存在线程安全问题，那么该如何解决这个问题呢？<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">public void doGet(HttpServletRequest request, HttpServletResponse response)</span><br><span class="line">             throws ServletException, IOException &#123;</span><br><span class="line">         /**</span><br><span class="line">          * 加了synchronized后，并发访问i时就不存在线程安全问题了，</span><br><span class="line">          * 为什么加了synchronized后就没有线程安全问题了呢？</span><br><span class="line">          * 假如现在有一个线程访问Servlet对象，那么它就先拿到了Servlet对象的那把锁</span><br><span class="line">          * 等到它执行完之后才会把锁还给Servlet对象，由于是它先拿到了Servlet对象的那把锁，</span><br><span class="line">          * 所以当有别的线程来访问这个Servlet对象时，由于锁已经被之前的线程拿走了，后面的线程只能排队等候了</span><br><span class="line">          * </span><br><span class="line">          */</span><br><span class="line">         synchronized (this) &#123;//在java中，每一个对象都有一把锁，这里的this指的就是Servlet对象</span><br><span class="line">             i++;</span><br><span class="line">             try &#123;</span><br><span class="line">                 Thread.sleep(1000*4);</span><br><span class="line">            &#125; catch (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">             response.getWriter().write(i+&quot;&quot;);</span><br><span class="line">         &#125;</span><br><span class="line">         </span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure></p>
<p>现在这种做法是给Servlet对象加了一把锁，保证任何时候都只有一个线程在访问该Servlet对象里面的资源，这样就不存在线程安全问题了，如下图所示：<br><img src="/img/线程结果.png" alt=""><br>这种做法虽然解决了线程安全问题，但是编写Servlet却万万不能用这种方式处理线程安全问题，假如有9999个人同时访问这个Servlet，那么这9999个人必须按先后顺序排队轮流访问。<br>针对Servlet的线程安全问题，Sun公司是提供有解决方案的：让Servlet去实现一个SingleThreadModel接口，如果某个Servlet实现了SingleThreadModel接口，那么Servlet引擎将以单线程模式来调用其service方法。<br>查看Sevlet的API可以看到，SingleThreadModel接口中没有定义任何方法和常量，在Java中，把没有定义任何方法和常量的接口称之为标记接口，经常看到的一个最典型的标记接口就是”Serializable”，这个接口也是没有定义任何方法和常量的，标记接口在Java中有什么用呢？主要作用就是给某个对象打上一个标志，告诉JVM，这个对象可以做什么，比如实现了”Serializable”接口的类的对象就可以被序列化，还有一个”Cloneable”接口，这个也是一个标记接口，在默认情况下，Java中的对象是不允许被克隆的，就像现实生活中的人一样，不允许克隆，但是只要实现了”Cloneable”接口，那么对象就可以被克隆了。</p>
<p>　　让Servlet实现了SingleThreadModel接口，只要在Servlet类的定义中增加实现SingleThreadModel接口的声明即可。<br>　　对于实现了SingleThreadModel接口的Servlet，Servlet引擎仍然支持对该Servlet的多线程并发访问，其采用的方式是产生多个Servlet实例对象，并发的每个线程分别调用一个独立的Servlet实例对象。<br>　　实现SingleThreadModel接口并不能真正解决Servlet的线程安全问题，因为Servlet引擎会创建多个Servlet实例对象，而真正意义上解决多线程安全问题是指一个Servlet实例对象被多个线程同时调用的问题。事实上，在Servlet API 2.4中，已经将SingleThreadModel标记为Deprecated（过时的）。  </p>
<ul>
<li>实现 SingleThreadModel 接口（已过时）</li>
<li>同步对共享数据的操作<br>　　使用synchronized 关键字能保证一次只有一个线程可以访问被保护的区段，在本论文中的Servlet可以通过同步块操作来保证线程的安全。</li>
<li>避免使用实例变量—-最佳选择。<br>　　本实例中的线程安全问题是由实例变量造成的，只要在Servlet里面的任何方法里面都不使用实例变量，那么该Servlet就是线程安全的。</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/20/利用ServletContext对象读取资源文件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qgx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qin12的学习博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/20/利用ServletContext对象读取资源文件/" itemprop="url">
                  javaweb (四 )
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-07-20 12:10:37" itemprop="dateCreated datePublished" datetime="2018-07-20T12:10:37+08:00">2018-07-20</time>
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/javaEE/" itemprop="url" rel="index"><span itemprop="name">javaEE</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="利用ServletContext对象读取资源文件"><a href="#利用ServletContext对象读取资源文件" class="headerlink" title="利用ServletContext对象读取资源文件"></a>利用ServletContext对象读取资源文件</h3><p>项目目录结构如下：<br><img src="/img/Demo8.png" alt=""></p>
<h4 id="代码范例：使用servletContext读取资源文件"><a href="#代码范例：使用servletContext读取资源文件" class="headerlink" title="代码范例：使用servletContext读取资源文件"></a>代码范例：使用servletContext读取资源文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.annotation.WebServlet;</span><br><span class="line">import javax.servlet.http.HttpServlet;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.FileNotFoundException;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import java.text.MessageFormat;</span><br><span class="line">import java.util.Properties;</span><br><span class="line"></span><br><span class="line">@WebServlet(name = &quot;ServletContextDemo7&quot;)</span><br><span class="line">public class ServletContextDemo7 extends HttpServlet &#123;</span><br><span class="line">    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">/**</span><br><span class="line"> * response.setContentType(&quot;text/html;charset=UTF-8&quot;);目的是控制浏览器用UTF-8进行解码；</span><br><span class="line"> * 这样就不会出现中文乱码了</span><br><span class="line"> */</span><br><span class="line">        response.setHeader(&quot;content-type&quot;, &quot;text/html;charset=UTF-8&quot;);</span><br><span class="line">        readSrcDirPropCfgFile(response);//读取src目录下的properties配置文件</span><br><span class="line">        response.getWriter().println(&quot;&lt;hr/&gt;&quot;);</span><br><span class="line">        readWebRootDirPropCfgFile(response);//读取WebRoot目录下的properties配置文件</span><br><span class="line">        response.getWriter().println(&quot;&lt;hr/&gt;&quot;);</span><br><span class="line">        readPropCfgFile(response);//读取src目录下的db.config包中的db3.properties配置文件</span><br><span class="line">        response.getWriter().println(&quot;&lt;hr/&gt;&quot;);</span><br><span class="line">        readPropCfgFile2(response);//读取src目录下的包中的db4.properties配置文件</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void readPropCfgFile2(HttpServletResponse response) throws IOException &#123;</span><br><span class="line">        InputStream in = this.getServletContext().getResourceAsStream(&quot;/WEB-INF/classes/db4.properties&quot;);</span><br><span class="line">        Properties prop = new Properties();</span><br><span class="line">        prop.load(in);</span><br><span class="line">        String driver = prop.getProperty(&quot;driver&quot;);</span><br><span class="line">        String url = prop.getProperty(&quot;url&quot;);</span><br><span class="line">        String username = prop.getProperty(&quot;username&quot;);</span><br><span class="line">        String password = prop.getProperty(&quot;password&quot;);</span><br><span class="line">        response.getWriter().println(&quot;读取src目录下的db.config包中的db3.properties配置文件：&quot;);</span><br><span class="line">        response.getWriter().print(</span><br><span class="line">                MessageFormat.format(</span><br><span class="line">                        &quot;driver=&#123;0&#125;,url=&#123;1&#125;,username=&#123;2&#125;,password=&#123;3&#125;&quot;,</span><br><span class="line">                        driver,url, username, password)</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 读取src目录下的db.config包中的db3.properties配置文件</span><br><span class="line">     * @param response</span><br><span class="line">     * @throws IOException</span><br><span class="line">     */</span><br><span class="line">    private void readPropCfgFile(HttpServletResponse response) throws IOException &#123;</span><br><span class="line">        //通过ServletContext获取web资源的绝对路径</span><br><span class="line">        String path = this.getServletContext().getRealPath(&quot;/WEB-INF/classes/db/config/db3.properties&quot;);</span><br><span class="line">        InputStream in = new FileInputStream(path);</span><br><span class="line">        Properties prop = new Properties();</span><br><span class="line">        prop.load(in);</span><br><span class="line">        String driver = prop.getProperty(&quot;driver&quot;);</span><br><span class="line">        String url = prop.getProperty(&quot;url&quot;);</span><br><span class="line">        String username = prop.getProperty(&quot;username&quot;);</span><br><span class="line">        String password = prop.getProperty(&quot;password&quot;);</span><br><span class="line">        response.getWriter().println(&quot;读取src目录下的db.config包中的db3.properties配置文件：&quot;);</span><br><span class="line">        response.getWriter().print(</span><br><span class="line">                MessageFormat.format(</span><br><span class="line">                        &quot;driver=&#123;0&#125;,url=&#123;1&#125;,username=&#123;2&#125;,password=&#123;3&#125;&quot;,</span><br><span class="line">                        driver,url, username, password)</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 通过ServletContext对象读取WebRoot目录下的properties配置文件</span><br><span class="line">     * “/”代表的是项目根目录</span><br><span class="line">     * @param response</span><br><span class="line">     * @throws IOException</span><br><span class="line">     */</span><br><span class="line">    private void readWebRootDirPropCfgFile(HttpServletResponse response) throws IOException &#123;</span><br><span class="line">        InputStream in = this.getServletContext().getResourceAsStream(&quot;/db2.properties&quot;);</span><br><span class="line">        Properties prop = new Properties();</span><br><span class="line">        prop.load(in);</span><br><span class="line">        String driver = prop.getProperty(&quot;driver&quot;);</span><br><span class="line">        String url = prop.getProperty(&quot;url&quot;);</span><br><span class="line">        String username = prop.getProperty(&quot;username&quot;);</span><br><span class="line">        String password = prop.getProperty(&quot;password&quot;);</span><br><span class="line">        response.getWriter().println(&quot;读取WebRoot目录下的db2.properties配置文件：&quot;);</span><br><span class="line">        response.getWriter().print(</span><br><span class="line">                MessageFormat.format(</span><br><span class="line">                        &quot;driver=&#123;0&#125;,url=&#123;1&#125;,username=&#123;2&#125;,password=&#123;3&#125;&quot;,</span><br><span class="line">                        driver,url, username, password)</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 读取src目录下的db.config包中的db3.properties配置文件</span><br><span class="line">     *</span><br><span class="line">     * @param response</span><br><span class="line">     * @throws IOException</span><br><span class="line">     */</span><br><span class="line">    private void readSrcDirPropCfgFile(HttpServletResponse response) throws IOException &#123;</span><br><span class="line">        //通过ServletContext获取web资源的绝对路径</span><br><span class="line">        String path = this.getServletContext().getRealPath(&quot;/WEB-INF/classes/db/config/db3.properties&quot;);</span><br><span class="line">        InputStream in = new FileInputStream(path);</span><br><span class="line">        Properties prop = new Properties();</span><br><span class="line">        prop.load(in);</span><br><span class="line">        String driver = prop.getProperty(&quot;driver&quot;);</span><br><span class="line">        String url = prop.getProperty(&quot;url&quot;);</span><br><span class="line">        String username = prop.getProperty(&quot;username&quot;);</span><br><span class="line">        String password = prop.getProperty(&quot;password&quot;);</span><br><span class="line">        response.getWriter().println(&quot;读取src目录下的db.config包中的db3.properties配置文件：&quot;);</span><br><span class="line">        response.getWriter().println(</span><br><span class="line">                MessageFormat.format(&quot;driver=&#123;0&#125;,url=&#123;1&#125;,username=&#123;2&#125;,password=&#123;3&#125;&quot;, driver, url, username, password)</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>通过ServletContext对象读取src目录下的db1.properties配置文件<br>InputStream in = this.getServletContext().getResourceAsStream(“/WEB-INF/classes/db1.properties”);<ul>
<li>通过ServletContext对象读取WebRoot目录下的properties配置文件<br>InputStream in = this.getServletContext().getResourceAsStream(“/db2.properties”);</li>
<li>读取src目录下的db.config包中的db3.properties配置文件<br>String path = this.getServletContext().getRealPath(“/WEB-INF/classes/db/config/db3.properties”);<br>InputStream in = new FileInputStream(path);</li>
</ul>
</li>
<li>读取src目录下的gacl.servlet.study包中的db4.properties配置文件<br>InputStream in = this.getServletContext().getResourceAsStream(“/WEB-INF/db4.properties”);</li>
</ul>
<p>运行结果：<br><img src="/img/Demo7.png" alt=""></p>
<h4 id="代码范例：使用类装载器读取资源文件"><a href="#代码范例：使用类装载器读取资源文件" class="headerlink" title="代码范例：使用类装载器读取资源文件"></a>代码范例：使用类装载器读取资源文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.annotation.WebServlet;</span><br><span class="line">import javax.servlet.http.HttpServlet;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line">import java.io.*;</span><br><span class="line">import java.text.MessageFormat;</span><br><span class="line">import java.util.Properties;</span><br><span class="line"></span><br><span class="line">@WebServlet(name = &quot;ServletContextDemo8&quot;)</span><br><span class="line">public class ServletContextDemo8 extends HttpServlet &#123;</span><br><span class="line">    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">        doGet(request, response);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">        response.setContentType(&quot;text/html;charset=UTF-8&quot;);</span><br><span class="line">        //response.setHeader(&quot;content-type&quot;,&quot;text/html;charset=UTF-8&quot;);</span><br><span class="line">   test1(response);</span><br><span class="line">        response.getWriter().println(&quot;&lt;hr/&gt;&quot;);</span><br><span class="line">        test2(response);</span><br><span class="line">        response.getWriter().println(&quot;&lt;hr/&gt;&quot;);</span><br><span class="line">        //test3();//并没有成功</span><br><span class="line">        test4();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void test4() throws IOException &#123;</span><br><span class="line">        String path = this.getServletContext().getRealPath(&quot;/WEB-INF/classes/01.avi&quot;);</span><br><span class="line">        String filename = path.substring(path.lastIndexOf(&quot;\\&quot;) + 1);//获取文件名</span><br><span class="line">        InputStream in = this.getServletContext().getResourceAsStream(&quot;/WEB-INF/classes/01.avi&quot;);</span><br><span class="line">        byte buffer[] = new byte[1024];</span><br><span class="line">        int len = 0;</span><br><span class="line">        OutputStream out = new FileOutputStream(&quot;e:\\&quot; + filename);</span><br><span class="line">        while ((len = in.read(buffer))&gt;0)&#123;</span><br><span class="line">            out.write(buffer,0,len);</span><br><span class="line">        &#125;</span><br><span class="line">        out.close();</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     *  通过类装载器读取资源文件的注意事项:不适合装载大文件，否则会导致jvm内存溢出</span><br><span class="line">     */</span><br><span class="line">    private void test3() &#123;</span><br><span class="line">        /**</span><br><span class="line">         * 01.avi是一个60多M的文件，使用类加载器去读取这个大文件时会导致内存溢出：</span><br><span class="line">         * 01.pdf 是一个200多M的文件，</span><br><span class="line">         * java.lang.OutOfMemoryError: Java heap space</span><br><span class="line">         */</span><br><span class="line">        InputStream in = ServletContextDemo8.class.getClassLoader().getResourceAsStream(&quot;01.pdf&quot;);</span><br><span class="line">        System.out.println(in);</span><br><span class="line">        //并没有试验成功</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 读取类路径下面、包下面的资源文件</span><br><span class="line">     * @param response</span><br><span class="line">     * @throws IOException</span><br><span class="line">     */</span><br><span class="line">    private void test2(HttpServletResponse response) throws IOException &#123;</span><br><span class="line">        //获取到装载当前类的类装载器</span><br><span class="line">        ClassLoader loader = ServletContextDemo8.class.getClassLoader();</span><br><span class="line">        //用类装载器读取src目录下的db1.properties配置文件</span><br><span class="line">        InputStream in = loader.getResourceAsStream(&quot;db4.properties&quot;);</span><br><span class="line">        Properties prop = new Properties();</span><br><span class="line">        prop.load(in);</span><br><span class="line">        String driver = prop.getProperty(&quot;driver&quot;);</span><br><span class="line">        String url = prop.getProperty(&quot;url&quot;);</span><br><span class="line">        String username = prop.getProperty(&quot;username&quot;);</span><br><span class="line">        String password = prop.getProperty(&quot;password&quot;);</span><br><span class="line">        response.getWriter().println(&quot;用类装载器读取src目录下的db4.properties配置文件：&quot;);</span><br><span class="line">        response.getWriter().print(</span><br><span class="line">                MessageFormat.format(</span><br><span class="line">                        &quot;driver=&#123;0&#125;,url=&#123;1&#125;,username=&#123;2&#125;,password=&#123;3&#125;&quot;,</span><br><span class="line">                        driver,url, username, password)</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 读取类路径下的资源文件</span><br><span class="line">     * @param response</span><br><span class="line">     * @throws IOException</span><br><span class="line">     */</span><br><span class="line">    private void test1(HttpServletResponse response) throws IOException &#123;</span><br><span class="line">        //获取到装载当前类的类装载器</span><br><span class="line">        ClassLoader loader = ServletContextDemo8.class.getClassLoader();</span><br><span class="line">        //用类装载器读取src目录下的db1.properties配置文件</span><br><span class="line">        InputStream in = loader.getResourceAsStream(&quot;db1.properties&quot;);</span><br><span class="line">        Properties prop = new Properties();</span><br><span class="line">        prop.load(in);</span><br><span class="line">        String driver = prop.getProperty(&quot;driver&quot;);</span><br><span class="line">        String url = prop.getProperty(&quot;url&quot;);</span><br><span class="line">        String username = prop.getProperty(&quot;username&quot;);</span><br><span class="line">        String password = prop.getProperty(&quot;password&quot;);</span><br><span class="line">        response.getWriter().println(&quot;用类装载器读取src目录下的db1.properties配置文件：&quot;);</span><br><span class="line">        response.getWriter().print(</span><br><span class="line">                MessageFormat.format(</span><br><span class="line">                        &quot;driver=&#123;0&#125;,url=&#123;1&#125;,username=&#123;2&#125;,password=&#123;3&#125;&quot;,</span><br><span class="line">                        driver,url, username, password)</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/img/Demo81.png" alt=""></p>
<h3 id="在客户端缓存Servlet的输出"><a href="#在客户端缓存Servlet的输出" class="headerlink" title="在客户端缓存Servlet的输出"></a>在客户端缓存Servlet的输出</h3><p>对于不经常变化的数据，在servlet中可以为其设置合理的缓存时间值，以避免浏览器频繁向服务器发送请求，提升服务器的性能。例如在ServletContextDemo5的doGet()方法<br>添加如下代码：</p>
<p> response.setDateHeader(“expires”,System.currentTimeMillis() + 24 <em> 3600 </em> 1000);<br> 找到浏览器缓存如图<br> <img src="/img/Demo82.png" alt=""></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/20/代理模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qgx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qin12的学习博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/20/代理模式/" itemprop="url">
                  代理模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-07-20 12:10:37" itemprop="dateCreated datePublished" datetime="2018-07-20T12:10:37+08:00">2018-07-20</time>
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/设计模式/" itemprop="url" rel="index"><span itemprop="name">设计模式</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="代理模式"><a href="#代理模式" class="headerlink" title="代理模式"></a>代理模式</h3><h4 id="定义："><a href="#定义：" class="headerlink" title="定义："></a>定义：</h4><p>   为其他对象提供一种代理以控制对这个对象的访问。在某些情况下，一个对象不适合或者不能直接引用另一个对象，而代理对象可以在客户端和目标对象之间起到中介的作用</p>
<h4 id="角色："><a href="#角色：" class="headerlink" title="角色："></a>角色：</h4><h5 id="1、抽象角色："><a href="#1、抽象角色：" class="headerlink" title="1、抽象角色："></a>1、抽象角色：</h5><p>声明真实对象和代理对象的共同接口。</p>
<h5 id="2、-代理角色："><a href="#2、-代理角色：" class="headerlink" title="2、 代理角色："></a>2、 代理角色：</h5><p>代理对象角色内部含有对真实对象的引用，从而可以操作真实对象，同时代理对象提供与真实对象相同的接口以便在任何时刻都能代替真实对象。同时，代理对象可以在执行真实对象操作时，附加其他的操作，相当于对真实对象进行封装。</p>
<h5 id="3、真实角色："><a href="#3、真实角色：" class="headerlink" title="3、真实角色："></a>3、真实角色：</h5><p>代理角色所代表的真实对象，是我们最终要引用的对象。</p>
<h4 id="分类："><a href="#分类：" class="headerlink" title="分类："></a>分类：</h4><h5 id="静态代理"><a href="#静态代理" class="headerlink" title="静态代理"></a>静态代理</h5><p>静态代理也就是在程序运行前就已经存在代理类的字节码文件，代理类和委托类的关系在运行前就确定了。</p>
<h5 id="示例："><a href="#示例：" class="headerlink" title="示例："></a>示例：</h5><h6 id="抽象角色，真实对象和代理对象共同的接口"><a href="#抽象角色，真实对象和代理对象共同的接口" class="headerlink" title="抽象角色，真实对象和代理对象共同的接口"></a>抽象角色，真实对象和代理对象共同的接口</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface UserInfo&#123;    </span><br><span class="line">       public void queryUser ();    </span><br><span class="line">       public void updateUser ();      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="真实角色"><a href="#真实角色" class="headerlink" title="真实角色"></a>真实角色</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class UserImpl implementsUserInfo&#123;    </span><br><span class="line"></span><br><span class="line">       @Override    </span><br><span class="line">       public void queryUser() &#123;    </span><br><span class="line">           //查询方法略...          </span><br><span class="line">       &#125;    </span><br><span class="line"></span><br><span class="line">       @Override    </span><br><span class="line">       public void updateUser() &#123;    </span><br><span class="line">            //修改方法略...          </span><br><span class="line">       &#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="代理角色"><a href="#代理角色" class="headerlink" title="代理角色"></a>代理角色</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">public class UserProxy implements UserInfo&#123;    </span><br><span class="line">   private UserInfo userImpl;    </span><br><span class="line"></span><br><span class="line">   public UserProxy(UserInfo userImpl) &#123;    </span><br><span class="line">       this.userImpl = userImpl;    </span><br><span class="line">   &#125;    </span><br><span class="line"></span><br><span class="line">   @Override    </span><br><span class="line">   public void queryUser() &#123; </span><br><span class="line">         //这里可以扩展，增加一些查询之前需要执行的方法   </span><br><span class="line">       //查询方法略...   </span><br><span class="line">         //这里可以扩展，增加一些查询之后需要执行的方法         </span><br><span class="line">   &#125;    </span><br><span class="line"></span><br><span class="line">   @Override    </span><br><span class="line">   public void updateUser() &#123;  </span><br><span class="line">         //这里可以扩展，增加一些修改之前需要执行的方法    </span><br><span class="line">       //修改方法略...   </span><br><span class="line">         //这里可以扩展，增加一些修改之后需要执行的方法         </span><br><span class="line">   &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">使用代理之后如何调用他的方法？</span><br><span class="line">public class Test &#123;    </span><br><span class="line">   public static void main(String[] args) &#123;    </span><br><span class="line">       UserInfo userImpl = new UserImpl();     </span><br><span class="line">       UserInfo userProxy = new UserProxy(userImpl);     </span><br><span class="line">             userProxy.queryUser(); </span><br><span class="line">       userProxy.updateUser();        </span><br><span class="line">   &#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="动态代理"><a href="#动态代理" class="headerlink" title="动态代理"></a>动态代理</h4><p>动态代理类的源码是程序在运行期间由JVM根据反射等机制动态生成的，所以不存在代理类的字节码文件。代理角色和真实角色的联系在程序运行时确定。</p>
<h5 id="示例：-1"><a href="#示例：-1" class="headerlink" title="示例："></a>示例：</h5><h5 id="抽象角色，真实对象和代理对象共同的接口-1"><a href="#抽象角色，真实对象和代理对象共同的接口-1" class="headerlink" title="抽象角色，真实对象和代理对象共同的接口"></a>抽象角色，真实对象和代理对象共同的接口</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface UserInfo&#123;    </span><br><span class="line">       public void queryUser ();    </span><br><span class="line">       public void updateUser ();      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="真实角色-1"><a href="#真实角色-1" class="headerlink" title="真实角色"></a>真实角色</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public class UserImpl implements UserInfo&#123;    </span><br><span class="line"></span><br><span class="line">       @Override    </span><br><span class="line">       public void queryUser() &#123;    </span><br><span class="line">           //查询方法略...          </span><br><span class="line">       &#125;    </span><br><span class="line"></span><br><span class="line">       @Override    </span><br><span class="line">       public void updateUser() &#123;    </span><br><span class="line">            //修改方法略...          </span><br><span class="line">       &#125;    </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="代理角色处理器："><a href="#代理角色处理器：" class="headerlink" title="代理角色处理器："></a>代理角色处理器：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">public class UserHandler implements InvocationHandler&#123;</span><br><span class="line"></span><br><span class="line">         privateUserInfo userImpl;</span><br><span class="line">         publicUserHandler(UserInfo userImpl2)&#123;</span><br><span class="line">                   this.userImpl= userImpl2;</span><br><span class="line">         &#125;</span><br><span class="line">         @Override</span><br><span class="line">         publicObject invoke(Object proxy, Method method, Object[] args) </span><br><span class="line">                                        throws Throwable &#123;</span><br><span class="line">                   Objectobject = null;</span><br><span class="line">       //方法开始前做一些事情</span><br><span class="line">       if (method.getName().equals(&quot;queryUser&quot;)) &#123;</span><br><span class="line">           object = method.invoke(userImpl, args);</span><br><span class="line">            //激活调用的方法   </span><br><span class="line">       &#125;</span><br><span class="line">       //方法结束后做一些事情</span><br><span class="line">       return object;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">如何调用（和静态代理略有不同）</span><br><span class="line">public class Test &#123;         </span><br><span class="line">   public static void main(String[] args) &#123;</span><br><span class="line">         UserInfouserImpl =new UserImpl();</span><br><span class="line">         UserHandlerhandler = new UserHandler(userImpl);</span><br><span class="line">         UserInfouserProxy = (UserInfo)Proxy.newProxyInstance</span><br><span class="line">                      (ClassLoader.getSystemClassLoader(),</span><br><span class="line">                        newClass[]&#123;UserInfo.class&#125;, handler);</span><br><span class="line">         userProxy.queryUser();</span><br><span class="line">         &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="优点："><a href="#优点：" class="headerlink" title="优点："></a>优点：</h4><p>   业务类只需要关注业务逻辑本身，保证了业务类的重用性。这是代理的共有优点。<br>   能够协调调用者和被调用者，在一定程度上降低了系统的耦合度。</p>
<h4 id="缺点："><a href="#缺点：" class="headerlink" title="缺点："></a>缺点：</h4><p>   由于在客户端和真实主题之间增加了代理对象，因此有些类型的代理模式可能会造成请求的处理速度变慢，例如保护代理。<br>         实现代理模式需要额外的工作，而且有些代理模式的实现过程较为复杂，例如远程代理。</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/20/数组和内存控制/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qgx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qin12的学习博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/20/数组和内存控制/" itemprop="url">
                  java基础知识(二)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-07-20 12:10:37" itemprop="dateCreated datePublished" datetime="2018-07-20T12:10:37+08:00">2018-07-20</time>
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="数组和内存控制"><a href="#数组和内存控制" class="headerlink" title="数组和内存控制"></a>数组和内存控制</h2><h3 id="Java的数组是静态的"><a href="#Java的数组是静态的" class="headerlink" title="Java的数组是静态的"></a>Java的数组是静态的</h3><ul>
<li>初始化方式：<pre><code>-1：静态初始化
    a：String[] S = new String[]{}
    b：String[] S = {       }
- 2：动态初始化
    String[] S = new String[5];&apos;
</code></pre><h3 id="动态初始化由系统分配初始值"><a href="#动态初始化由系统分配初始值" class="headerlink" title="动态初始化由系统分配初始值"></a>动态初始化由系统分配初始值</h3><pre><code>类型                                             初始化值
整型（int short byte long)                          0
浮点（float double)                                 0.0
字符(char)                                        &apos;\u0000&apos;
布尔（boolean)                                      false
引用类型（类  接口  数组）                              null
</code></pre></li>
<li>Java 的数组变量是引用类型的变量，它并不是数组对象本身，只要让数组变量指向有效的数组对象，程序中即可使用该数组变量。</li>
<li>对数组的初始化并不是对数组变量实行初始化，而是要对数组对象初始化—–也就是为该数组对象分配一块连续的内存空间。</li>
<li>所有局部变量都是放在栈内存里保存的，不管是基本类型的变量，还是引用类型的变量，都是存储各自的方法栈里，但引用类型变量所引用的对象【包括数组、普通Java对象】则都是存储在堆内存里面。</li>
<li>对于Java语言来说，堆内存中的对象【不管是数组对象还是普通的Java对象】通常不允许直接访问，为了访问堆内存中的对象，通常智能通过引用变量。</li>
<li>引用变量本质上就是一个指针，只要程序通过引用变量访问属性，或者通过引用变量来调用方法，该引用变量将会被它所引用的对象代替。<h3 id="Runtime异常-NullPointerException（空指针异常）"><a href="#Runtime异常-NullPointerException（空指针异常）" class="headerlink" title="Runtime异常 NullPointerException（空指针异常）"></a>Runtime异常 NullPointerException（空指针异常）</h3></li>
<li>当通过引用变量来访问实例属性或者调用静态方法时，如果该引用变量还未引用一个有效的对象，程序就会引发空指针异常$ 引用数组类型的数组元素依然是引用类型，因此数组元素里存储的还是引用，它指向另一块内存，这块内存存储了该引用变量所引用的对象。<ul>
<li>Java语言避免直接访问堆内存里面的数据可以保证程序的健壮性，如果程序直接访问并修改堆内存中的数据，可能破坏内存中数据的完整性，导致程序Crash<h3 id="数组元素就是变量"><a href="#数组元素就是变量" class="headerlink" title="数组元素就是变量"></a>数组元素就是变量</h3><h3 id="没有多维数组"><a href="#没有多维数组" class="headerlink" title="没有多维数组"></a>没有多维数组</h3></li>
</ul>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/20/集合框架/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qgx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qin12的学习博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/20/集合框架/" itemprop="url">
                  java 基础知识
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-07-20 12:10:37" itemprop="dateCreated datePublished" datetime="2018-07-20T12:10:37+08:00">2018-07-20</time>
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="集合框架"><a href="#集合框架" class="headerlink" title="集合框架"></a>集合框架</h3><h4 id="1：String类：字符串-重点"><a href="#1：String类：字符串-重点" class="headerlink" title="1：String类：字符串(重点)"></a>1：String类：字符串(重点)</h4><ul>
<li>(1)多个字符组成的一个序列，叫字符串。<br>生活中很多数据的描述都采用的是字符串的。而且我们还会对其进行操作。<br>所以，java就提供了这样的一个类供我们使用。</li>
<li>(2)创建字符串对象</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">A:String():无参构造</span><br><span class="line">举例：</span><br><span class="line"> String s = new String();</span><br><span class="line"> s = &quot;hello&quot;;</span><br><span class="line"> sop(s);</span><br><span class="line">B:String(byte[] bys):传一个字节数组作为参数 *****</span><br><span class="line">举例</span><br><span class="line"> byte[] bys = &#123;97,98,99,100,101&#125;;</span><br><span class="line"> String s = new String(bys);</span><br><span class="line"> sop(s);</span><br><span class="line">C:String(byte[] bys,int index,int length):把字节数组的一部分转换成一个字符串 *****</span><br><span class="line">举例</span><br><span class="line"> byte[] bys = &#123;97,98,99,100,101&#125;;</span><br><span class="line"> String s = new String(bys,1,2);</span><br><span class="line"> sop(s);</span><br><span class="line">D:String(char[] chs):传一个字符数组作为参数 *****</span><br><span class="line">举例</span><br><span class="line"> char[] chs = &#123;&apos;a&apos;,&apos;b&apos;,&apos;c&apos;,&apos;d&apos;,&apos;e&apos;&#125;;</span><br><span class="line"> String s = new String(chs);</span><br><span class="line"> sop(s);</span><br><span class="line">E:String(char[] chs,int index,int length):把字符数组的一部分转换成一个字符串 *****</span><br><span class="line">举例</span><br><span class="line"> char[] chs = &#123;&apos;a&apos;,&apos;b&apos;,&apos;c&apos;,&apos;d&apos;,&apos;e&apos;&#125;;</span><br><span class="line"> String s = new String(chs,1,2);</span><br><span class="line"> sop(s);</span><br><span class="line">F:String(String str):把一个字符串传递过来作为参数</span><br><span class="line"> char[] chs = &#123;&apos;a&apos;,&apos;b&apos;,&apos;c&apos;,&apos;d&apos;,&apos;e&apos;&#125;;</span><br><span class="line"> String ss = new String(s);</span><br><span class="line"> sop(ss);</span><br><span class="line">G:直接把字符串常量赋值给字符串引用对象(最常用) *****</span><br><span class="line">举例</span><br><span class="line"> String s = &quot;hello&quot;;</span><br><span class="line"> sop(s);</span><br></pre></td></tr></table></figure>
<h4 id="3-面试题"><a href="#3-面试题" class="headerlink" title="(3)面试题"></a>(3)面试题</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">A:请问String s = new String(&quot;hello&quot;);创建了几个对象。</span><br><span class="line"> 两个。一个&quot;hello&quot;字符串对象，在方法区的常量池；一个s对象，在栈内存。</span><br><span class="line">B:请写出下面的结果</span><br><span class="line">String s1 = new String(&quot;abc&quot;);</span><br><span class="line">Strign s2 = new String(&quot;abc&quot;);</span><br><span class="line">String s3 = &quot;abc&quot;;</span><br><span class="line">String s4 = &quot;abc&quot;;</span><br><span class="line">sop(s1==s2);  //false</span><br><span class="line">sop(s1==s3);  //false</span><br><span class="line">sop(s3==s4);  //true</span><br><span class="line">C:字符串对象一旦被创建就不能被改变。</span><br><span class="line">指的是字符串常量值不改变。</span><br></pre></td></tr></table></figure>
<p>(4)字符串中各种功能的方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">A:判断</span><br><span class="line">boolean equals(Object anObject):判断两个字符串的内容是否相同，复写了Object的方法</span><br><span class="line">boolean equalsIgnoreCase(String anotherString):判断两个字符串的内容是否相同，</span><br><span class="line">不区分大小写</span><br><span class="line">boolean contains(String s):判断一个字符串中是否包含另一个字符串</span><br><span class="line">注意：判断字符串是否包含特殊字符.直接表示为str.contains(&quot;.&quot;)</span><br><span class="line">boolean endsWith(String suffix):测试此字符串是否以指定的后缀结束</span><br><span class="line">boolean startsWith(String suffix):测试此字符串是否以指定的前缀开始</span><br><span class="line">boolean isEmpty():测试字符串是否为空</span><br><span class="line">B:获取</span><br><span class="line">int length():返回此字符串的长度</span><br><span class="line">char charAt(int index):返回指定索引处的 char值</span><br><span class="line">int indexOf(int ch):返回指定字符在此字符串中第一次出现处的索引。 </span><br><span class="line">int indexOf(int ch, int fromIndex):返回在此字符串中第一次出现指定字符处的索引，</span><br><span class="line">  从指定的索引开始搜索。 </span><br><span class="line">int indexOf(String str):返回指定子字符串在此字符串中第一次出现处的索引。 </span><br><span class="line">int indexOf(String str, int fromIndex):返回指定子字符串在此字符串中第一次</span><br><span class="line">出现处的索引，从指定的索引开始。 </span><br><span class="line">int lastIndexOf(int ch)：返回指定字符在此字符串中最后一次出现处的索引。 </span><br><span class="line">int lastIndexOf(int ch, int fromIndex) </span><br><span class="line">返回指定字符在此字符串中最后一次出现处的索引,从指定的索引处开始进行反向搜索。 </span><br><span class="line">int lastIndexOf(String str) </span><br><span class="line">返回指定子字符串在此字符串中最右边出现处的索引。 </span><br><span class="line">int lastIndexOf(String str, int fromIndex) </span><br><span class="line">返回指定子字符串在此字符串中最后一次出现处的索引，从指定的索引开始反向搜索。 </span><br><span class="line">String substring(int beginIndex) (注意：该方法substring的String是小写！！！)</span><br><span class="line">返回一个新的字符串，它是此字符串的一个子字符串。 </span><br><span class="line">String substring(int beginIndex, int endIndex) (注意该方法的String是小写！！！)</span><br><span class="line">返回一个新字符串，它是此字符串的一个子字符串,包含头不包含尾。 </span><br><span class="line">C:转换</span><br><span class="line">byte[] getBytes()：(很常用！)从字符串到字节数组的方法</span><br><span class="line">void getChars(int srcBegin, int srcEnd, char[] dst, int dstBegin) </span><br><span class="line">将字符从此字符串复制到目标字符数组。 </span><br><span class="line">char[] toCharArray()：(很常用！)从字符串到字符数组的方法</span><br><span class="line">static String copyValueOf(char[] data) </span><br><span class="line">返回指定数组中表示该字符序列的 String。 </span><br><span class="line">static String copyValueOf(char[] data, int offset, int count) </span><br><span class="line">返回指定数组中表示该字符序列的 String。 </span><br><span class="line">static String valueOf(数据类型):把该数据类型的数据转换成字符串。</span><br><span class="line">String toLowerCase()：把字符串转换成小写</span><br><span class="line">String toUpperCase()：把字符串转换成大写</span><br><span class="line">字符串的连接</span><br><span class="line">String concat(String str):将指定字符串连接到此字符串的结尾。</span><br><span class="line">D:替换</span><br><span class="line">String replace(char oldChar, char newChar):用新字符替换旧字符(替换所有)</span><br><span class="line">String replace(String target, String replacement):用新的子串换旧串</span><br><span class="line">E:分割</span><br><span class="line">String[] split(String regex)：根据指定的字符串把一个字符串分割成一个字符串数组</span><br><span class="line">F:</span><br><span class="line"></span><br><span class="line">String trim():去除字符串的前后空格</span><br><span class="line">G:</span><br><span class="line"></span><br><span class="line">int compareTo(String anotherString) </span><br><span class="line">按字典顺序比较两个字符串。 </span><br><span class="line">int compareToIgnoreCase(String str) </span><br><span class="line">按字典顺序比较两个字符串，不考虑大小写。</span><br></pre></td></tr></table></figure></p>
<p>(5)练习<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">1:模拟登录,给三次机会,并提示还有几次.</span><br><span class="line">默认的用户名和密码为admin。 区分大小写。</span><br><span class="line">自己从键盘输入用户名和密码。</span><br><span class="line">2:给定一个字符串统计,统计大写字母,小写字母,数字出现的个数.</span><br><span class="line">注意:不包括特殊字符</span><br><span class="line">从键盘输入一个不包含特殊字符的字符串(只有26个字母和0-9组成)。</span><br><span class="line">3:给定一个字符串,把它变成首字母大写,其他字母小写的字符串.</span><br><span class="line">从键盘输入一个字符串，全部26个字母组成的。</span><br><span class="line">4:子串在整串中出现的次数。</span><br><span class="line">也就是说:获取一个字符串中,指定的字串在该字符串中出现的次数.</span><br><span class="line">例如:</span><br><span class="line">&quot;nbasdnbafllgnbahjnbakqqqqlnba&quot;  在这个字符串中，多有个nba.</span><br><span class="line">5:对字符串中字符进行自然顺序排序。</span><br><span class="line">&quot;basckd&quot;--&gt;&quot;abcdks&quot;</span><br><span class="line">先留做思考内容：</span><br><span class="line">6:两个字符串的最大相同子串。</span><br><span class="line">两个字符串的最大相同子串。</span><br><span class="line">比如:</span><br><span class="line">&quot;sadabcdfghjkl&quot;</span><br><span class="line">werabcdtyu&quot;</span><br></pre></td></tr></table></figure></p>
<h4 id="2：StringBuffer"><a href="#2：StringBuffer" class="headerlink" title="2：StringBuffer"></a>2：StringBuffer</h4><p>(1)字符串的缓冲区，是一个容器。<br>(2)它和String的区别<br>它是缓冲区可变长度的。<br>(3)构造方法<br>StringBuffer() 构造一个其中不带字符的字符串缓冲区，初始容量为 16 个字符。<br>StringBuffer(int num) 构造一个不带字符，但具有指定初始容量的字符串缓冲区。<br>StringBuffer(String str) 构造一个字符串缓冲区，并将其内容初始化为指定的字符串内容。<br>(4)常用方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">A:增加数据</span><br><span class="line">append ：添加各种类型的数据</span><br><span class="line">insert : 在容器指定位置插入各种类型的数据。</span><br><span class="line">B:删除数据</span><br><span class="line">deleteCharAt : 删除指定位置的字符</span><br><span class="line">delete 还可以用于清空StringBuffer的缓冲区</span><br><span class="line">C:替换</span><br><span class="line">replace</span><br><span class="line">D:获取 </span><br><span class="line">charAt </span><br><span class="line">E:长度和容量</span><br><span class="line">length() 元素的个数</span><br><span class="line">capacity 元素的理论值</span><br><span class="line">F:获取元素的位置</span><br><span class="line">indexOf</span><br><span class="line">lastIndexOf</span><br><span class="line">G:截取</span><br><span class="line">substring(int start)</span><br><span class="line">substring(int start,int end)</span><br><span class="line">H:反转</span><br><span class="line">reverse</span><br></pre></td></tr></table></figure></p>
<p>(5)字符串和StringBuffer的转换<br>String–&gt;StringBuffer通过构造:<br>如:StringBuffer sb = new StringBuffer(String str)<br>StringBuffer–String通过toString方法<br>如:StringBuffer sb = new StringBuffer();<br>  sb.toString();</p>
<h4 id="3：StringBuilder"><a href="#3：StringBuilder" class="headerlink" title="3：StringBuilder"></a>3：StringBuilder</h4><p>和StringBuffer的功能是一样的，但是有区别：<br>StringBuffer(JDK1.0)是线程安全的。<br>StringBuilder(JDK1.5)不保证线程安全。<br>一般来说，我们写的程序都是单线程的，所以，用StringBuilder，效率高。<br>JDK版本的升级原则：<br>A:提高效率<br>B:提高安全性<br>C:简化书写</p>
<h4 id="4：基本数据类型的对象包装类"><a href="#4：基本数据类型的对象包装类" class="headerlink" title="4：基本数据类型的对象包装类"></a>4：基本数据类型的对象包装类</h4><p>(1)为了更方便的操作每个基本数据类型，java对其提供了很多的属性和方法供我们使用。<br>(2)用途：<br>将基本数据类型封装成对象的好处在于可以在对象中定义更多的功能操作该数据。<br>常用的操作之一：用于基本数据类型与字符串之间的转换。</p>
<ul>
<li>A:方便操作</li>
<li>B:用于和字符串进行相互转换</li>
</ul>
<p>(3)基本数据类型和对象类型的对应<br>byte<br>Byte<br>short Short<br>int Integer<br>long Long<br>float Float<br>double Double<br>boolean  Boolean<br>char Character<br>(4)构造方法<br>字段摘要：<br>static int MAX_VALUE 值为 2^31-1 的常量，它表示 int 类型能够表示的最大值<br>static int MIN_VALUE  值为 -2^31 的常量，它表示 int 类型能够表示的最小值<br>static Class<integer> TYPE 表示基本类型int的Class 实例</integer></p>
<p>Integer(int value) 构造一个新分配的Integer对象，它表示指定的int值。<br>Inreger(String s) 注意：s必须是纯数字的字符串。否则会有异常NumberFormatException</p>
<p>(5)几个常用的方法<br>Integer.toBinaryString();<br>以二进制（基数 2）无符号整数形式返回一个整数参数的字符串表示形式。<br>Integer.toOctalString();<br>以八进制（基数 8）无符号整数形式返回一个整数参数的字符串表示形式。<br>Integer.toHexString();<br>以十六进制（基数 16）无符号整数形式返回一个整数参数的字符串表示形式。<br>static int Integer.parseInt(String s) 将字符串参数作为有符号的十进制整数进行解析,<br>字符串必须是int型范围内的数字字符串<br>static int Integer.parseInt(String s,int basic)<br>使用第二个参数指定的基数,将字符串参数解析为有符号的整数.<br>字符串必须是int型范围内的数字字符串<br>short shortValue() 以short类型返回该Integer的值。<br>int intValue() 以int类型返回该Integer的值。<br>static Integer valueOf(int num) 返回一个表示指定的 int 值的 Integer 实例。<br>static Integer valueOf(String s) 返回保存指定的String的值的Integer对象。<br>                static Integer valueOf(String s, int radix)<br>返回一个Integer对象，该对象中保存了用第二个参数提供的基数进行<br>解析时从指定的String中提取的值。<br>(6)类型转换<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">int -- Integer</span><br><span class="line">int num = 20;</span><br><span class="line">A:Integer i = new Integer(num);</span><br><span class="line">B:Integer i = Integer.valueOf(num);</span><br><span class="line">Integer -- int</span><br><span class="line">Integer i = new Integer(20);</span><br><span class="line">A:int num = i.intValue();</span><br><span class="line">int -- String</span><br><span class="line">int num = 20;</span><br><span class="line">A:String s = String.valueOf(num);</span><br><span class="line">B:String s = &quot;&quot;+num;</span><br><span class="line">C:String s = Integer.toString(num);</span><br><span class="line">String -- int</span><br><span class="line">String s = &quot;20&quot;;</span><br><span class="line">A:int num = Integer.parseInt(s);</span><br><span class="line">B:Integer i = new Integer(s);或者Integer i = Integer.valueOf(s);</span><br><span class="line"> int num = i.intValue();</span><br></pre></td></tr></table></figure></p>
<h4 id="5、集合框架："><a href="#5、集合框架：" class="headerlink" title="5、集合框架："></a>5、集合框架：</h4><p>(1)为什么出现集合类？<br>面向对象对事物的体现都是以对象的形式，为了方便对多个对象的操作，就对对象进行存储。<br>集合就是存储对象最常用的一种方式.<br>(2)数组和集合都是容器，两者有何不同？<br>数组长度固定，而集合长度是可变的<br>数组值可以存储对象，还可以存储基本数据类型;而集合只能存储对象<br>数组存储数据类型是固定的，而集合存储的数据类型不固定<br>(3)集合类的特点：<br>集合只能存储对象<br>集合的长度是可变的<br>集合可以存储不同类型的对象<br>(4)集合类框架(重要！！！要分清几种容器间的区别)：<br>Collection:顶层接口<br>    |—&gt;List:列表，元素是有序的(元素带角标索引)，可以有重复元素,可以有null元素。<br>           |—&gt;ArrayList(JDK1.2):底层的数据结构是数组数据结构，特点是查询速度快(因为带角标)，<br>  但是增删速度稍慢,因为当元素多时，增删一个元素则所有元素的角标都得改变<br>  线程不同步。默认长度是10，当超过长度时，按50%延长集合长度。<br>   |—&gt;LinkedList(JDK1.2):底层数据结构式链表数据结构(即后面一个元素记录前一个)，<br>   特点：查询速度慢，因为每个元素只知道前面一个元素，但增删速度快<br>   因为元素再多，增删一个，只要让其前后的元素重新相连即可<br>   线程是不同步的。<br>   |—&gt;Vector(JDK1.0):底层数据结构是数组数据结构.特点是查询和增删速度都很慢。<br>默认长度是10，当超过长度时,按100%延长集合长度。<br>线程同步。<br>(Vector功能跟ArrayList功能一模一样，已被ArrayList替代)</p>
<h5 id="List使用注意！"><a href="#List使用注意！" class="headerlink" title="List使用注意！"></a>List使用注意！</h5><p>|—&gt;ArrayList:<br>(1)当往ArrayList里面存入元素没什么要求时，即只要求有序就行时；</p>
<p>(2)当往ArrayList里面存入元素要求不重复时，比如存入学生对象，当同名同姓时<br>  视为同一个人，则不往里面存储。则定义学生对象时，需复写equals方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">  public boolean equals(Object obj)</span><br><span class="line">  &#123;</span><br><span class="line">if(!(obj instanceof Student))</span><br><span class="line">return false;</span><br><span class="line">Student stu = (Student)obj;</span><br><span class="line">return this.name.equals(stu.name)&amp;&amp;this.age==stu.age;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>  则往ArrayList集合通过add存入学生对象时，集合底层自己会调用学生类的equals方法，<br>  判断重复学生则不存入。<br>注：对于List集合，无论是add、contains、还是remove方法，判断元素是否相同，<br>    都是通过复写equals方法来判断！</p>
<p>|—&gt;LinkedList<br>(1)LinkLedist的特有方法：<br>boolean offerFirst(E e)  在此列表的开头插入指定的元素。<br>boolean offerLast(E e) 在此列表末尾插入指定的元素。<br>E peekFirst() 获取但不移除此列表的第一个元素；如果此列表为空，则返回 null。<br>E peekLast() 获取但不移除此列表的最后一个元素；如果此列表为空，则返回 null。<br>E pollFirst() 获取并移除此列表的第一个元素；如果此列表为空，则返回 null。<br>E pollLast() 获取并移除此列表的最后一个元素；如果此列表为空，则返回 null。<br>(2)通过LinkLedist的特有方法，可以实现某些数据特殊方式的存取，比如堆栈和队列。</p>
<p>一般情况下，使用哪种List接口下的实现类呢？<br>如果要求增删快，考虑使用LinkedList<br>如果要求查询快，考虑使用ArrayList<br>如果要求线程安全，考虑使用Vector。</p>
<p>|—&gt;Set:集合，元素是无序的(因为没有索引)，元素不可以重复。可以有null元素。<br>   |—&gt;HashSet(JDK1.2):底层数据结构是哈希表、存取速度快、元素唯一、线程不同步。<br>保证性元素唯一的原理:<br>先判断元素的hashCode值是否相同，再判断两元素的equals方法是否为true<br>(往HashSet里面存的自定义元素要复写hashCode和equals方法，<br>以保证元素的唯一性！)<br>|—&gt;TreeSet:底层数据结构式二叉树。可以对Set集合中的元素进行排序。元素有序、线程不同步。<br>保证元素唯一性的依据：compareTo方法return 0<br>TreeSet排序的第一种方式:让元素自身具备比较性，比如八种基本数据类型或则字符串，<br>实现Compareble接口,覆盖compareTo方法，<br>此方式是元素的自然顺序<br>TreeSet排序的第一种方式:当元素自身不具备比较性(比如存储学生对象时)或者具备的<br>比较性不是我们所需要的比较性时(比如想字符串的长度排序),<br>此时就需要让集合自身具备自定义的比较性。<br>那如何让集合自身具备比较性呢？可在集合初始化时，<br>就让集合具备比较方式。即定义一个类，<br>实现Comparator接口，覆盖compare方法。</p>
<h5 id="Set集合使用注意事项："><a href="#Set集合使用注意事项：" class="headerlink" title="Set集合使用注意事项："></a>Set集合使用注意事项：</h5><p>(1)HashSet:<br>     通过new的方式往HashSet里面存的元素的hashCode都不同，但通常我们定义对象，<br>     比如学生对象时，虽然是new的两个学生对象，但是当他们name和age一样时，我们认为是<br>     同一个对象，所以为了保证元素的唯一性，我们通常在往HashSet集合里面存储元素时，<br>     在定义对象的类中通常复写hashCode和equals方法。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">     public int hashCode()</span><br><span class="line">     &#123;</span><br><span class="line">return name.hashCode()+age*39;</span><br><span class="line">     &#125;</span><br><span class="line">     public boolean equals(Object obj)</span><br><span class="line">     &#123;</span><br><span class="line">if(!(obj instanceof Student))</span><br><span class="line">return false;</span><br><span class="line">Student stu = (Student)obj;</span><br><span class="line">return this.name.equals(stu.name)&amp;&amp;this.age==stu.age;</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure></p>
<pre><code>HashSet是如何保证元素唯一性的呢？
  如果两元素的hashCode值不同，则不会调用equals方法
  如果两元素的hashCode值相同，则继续判断equals是否返回true；
  hashCode和equals方法虽然定义在自定义对象类里面，但不是我们手动调用
   而是往HashSet集合里面存储元素的时候，集合底层自己调用hashCode和equals
</code></pre><p>它自己拿对象去判断，自己判断两元素是否是同一个元素。</p>
<p>(2)TreeSet:<br>    TreeSet要求往里面存的元素具备比较性，否则会报错。<br>    TreeSet排序的第一种方式:让元素自身具备比较性<br> 定义对象类，实现Compareble接口,复写compareTo方法，此方式是元素的自然顺序<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"> class Student implements Comparable</span><br><span class="line"> &#123;</span><br><span class="line">private String name;</span><br><span class="line">private int age;</span><br><span class="line">public Student(String name,int age)</span><br><span class="line">&#123;</span><br><span class="line">this.name=name;</span><br><span class="line">this.age=age;</span><br><span class="line">&#125;</span><br><span class="line">public String getName()</span><br><span class="line">&#123;</span><br><span class="line">return name;</span><br><span class="line">&#125;</span><br><span class="line">public int getAge()</span><br><span class="line">&#123;</span><br><span class="line">return age;</span><br><span class="line">&#125;</span><br><span class="line">public int compareTo(Object obj)</span><br><span class="line">&#123;</span><br><span class="line">if(!(obj instanceof Student))</span><br><span class="line">throw new RuntimeException(&quot;不是学生对象！&quot;);</span><br><span class="line">Student stu = (Student)obj;</span><br><span class="line">int num = this.age-stu.age;</span><br><span class="line">if(num==0)</span><br><span class="line">return this.name.compareTo(stu.name);</span><br><span class="line">return num;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>   TreeSet排序的第一种方式:让集合具备比较性<br>当元素自身不具备比较性(比如存储学生对象时)或者具备的<br>比较性不是我们所需要的比较性时(比如想字符串的长度排序),<br>此时就需要让集合自身具备自定义的比较性。<br>那如何让集合自身具备比较性呢？可在集合初始化时，<br>就让集合具备比较方式。即定义一个类，<br>实现Comparator接口，覆盖compare方法。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">class StringLengthComparator implements Comparator</span><br><span class="line">&#123;</span><br><span class="line">public int compare(Object obj1,Object obj2)</span><br><span class="line">&#123;</span><br><span class="line">String s1 = (String)obj1;</span><br><span class="line">String s2 = (String)obj2;</span><br><span class="line">int num = new Integer(s1.length()).compareTo(new Integer(s2.length()));</span><br><span class="line">if(num==0)</span><br><span class="line">return s1.compareTo(s2);</span><br><span class="line">return num;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">class TreeSetTest</span><br><span class="line">&#123;</span><br><span class="line">public static void main(String[] args)</span><br><span class="line">&#123;</span><br><span class="line">TreeSet ts = new TreeSet(new StringLengthComparator());</span><br><span class="line">ts.add(&quot;addfg&quot;);</span><br><span class="line">ts.add(&quot;dfg&quot;);</span><br><span class="line">ts.add(&quot;agtuug&quot;);</span><br><span class="line">ts.add(&quot;vgjkg&quot;);</span><br><span class="line">sop(ts);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>基本数据类型或字符串对象均实现了Comparable接口，故同种类型基本数据间具备比较性，即自然顺序。</p>
<p>Map:顶层接口,该集合存储的是键值对,而且键是唯一的,Map和Set很像,Set集合底层就是使用了Map集合。<br>Map集合没有迭代器，要取出元素必须先将Map集合转换成Set集合才能遍历元素<br>  |—&gt;HashTable(JDK1.0):<br>底层是哈希表数据结构；<br>不可以使用null键和null值；<br>用作键的对象必须实现hashCode和equals方法来保证键的唯一性<br>线程同步，效率低<br>  |—&gt;HashMap(JDK1.2):<br>底层是哈希表数据结构；<br>允许使用null键和null值；<br>线程不同步，效率高；<br>保证元素唯一性的:<br>原理：先判断元素的hashCode值是否相同，再判断两元素的equals方法是否为true<br>(往HashSet里面存的自定义元素要复写hashCode和equals方法，<br>以保证元素的唯一性！)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">class Student &#123;</span><br><span class="line">private String name;</span><br><span class="line">private int age;</span><br><span class="line">public Student(String name, int age) &#123;</span><br><span class="line">super();</span><br><span class="line">this.name = name;</span><br><span class="line">this.age = age;</span><br><span class="line">&#125;</span><br><span class="line">public int getAge() &#123;</span><br><span class="line">return age;</span><br><span class="line">&#125;</span><br><span class="line">public void setAge(int age) &#123;</span><br><span class="line">this.age = age;</span><br><span class="line">&#125;</span><br><span class="line">public String getName() &#123;</span><br><span class="line">return name;</span><br><span class="line">&#125;</span><br><span class="line">public void setName(String name) &#123;</span><br><span class="line">this.name = name;</span><br><span class="line">&#125;</span><br><span class="line">@Override</span><br><span class="line">public int hashCode()&#123;</span><br><span class="line">return name.hashCode()+age*34;</span><br><span class="line">&#125;</span><br><span class="line">@Override</span><br><span class="line">public boolean equals(Object obj)&#123;</span><br><span class="line">if(!(obj instanceof Student))</span><br><span class="line">return false;</span><br><span class="line">Student stu = (Student)obj;</span><br><span class="line">return this.name.equals(stu.name)&amp;&amp;this.age==stu.age;</span><br><span class="line">&#125;</span><br><span class="line">public class HashMapDemo1 &#123;</span><br><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">Map&lt;Student , String&gt; hmap = new HashMap&lt;Student , String&gt;();</span><br><span class="line">hmap.put(new Student(&quot;001&quot;,20), &quot;beijing&quot;);</span><br><span class="line">hmap.put(new Student(&quot;002&quot;,25), &quot;hebei&quot;);</span><br><span class="line">hmap.put(new Student(&quot;003&quot;,50), &quot;hainan&quot;);</span><br><span class="line">hmap.put(new Student(&quot;001&quot;,20), &quot;beijing&quot;);</span><br><span class="line">System.out.println(hmap.size());</span><br><span class="line">Set&lt;Student&gt; keySet = hmap.keySet();</span><br><span class="line">Iterator&lt;Student&gt; it = keySet.iterator();</span><br><span class="line">while(it.hasNext())&#123;</span><br><span class="line">Student stu = it.next();</span><br><span class="line">String addr = hmap.get(stu);</span><br><span class="line">System.out.println(stu.getName()+&quot;..&quot;+stu.getAge()+&quot;::&quot;+addr);</span><br><span class="line">&#125;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>  |—&gt;TreeMap(JDK1.0):<br>底层是二叉树结构；<br>允许使用null键和null值；<br>线程不同步；<br>可以给Map集合中的键进行排序.<br>TreeMap排序的第一种方式:让元素自身具备比较性，比如八种基本数据类型或则字符串，<br>实现Compareble接口,覆盖compareTo方法，<br>此方式是元素的自然顺序<br>TreeMap排序的第一种方式:当元素自身不具备比较性(比如存储学生对象时)或者具备的<br>比较性不是我们所需要的比较性时(比如想字符串的长度排序),<br>此时就需要让集合自身具备自定义的比较性。<br>那如何让集合自身具备比较性呢？可在集合初始化时，<br>就让集合具备比较方式。即定义一个类，<br>实现Comparator接口，覆盖compare方法。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">class Student implements Comparable&lt;Student&gt;&#123;</span><br><span class="line">private String name;</span><br><span class="line">private int age;</span><br><span class="line">public Student(String name, int age) &#123;</span><br><span class="line">super();</span><br><span class="line">this.name = name;</span><br><span class="line">this.age = age;</span><br><span class="line">&#125;</span><br><span class="line">public int getAge() &#123;</span><br><span class="line">return age;</span><br><span class="line">&#125;</span><br><span class="line">public void setAge(int age) &#123;</span><br><span class="line">this.age = age;</span><br><span class="line">&#125;</span><br><span class="line">public String getName() &#123;</span><br><span class="line">return name;</span><br><span class="line">&#125;</span><br><span class="line">public void setName(String name) &#123;</span><br><span class="line">this.name = name;</span><br><span class="line">&#125;</span><br><span class="line">@Override</span><br><span class="line">public int compareTo(Student stu) &#123;</span><br><span class="line">int num = newInteger(this.age).compareTo(new Integer(stu.age));</span><br><span class="line">if(num==0)</span><br><span class="line">return this.name.compareTo(stu.name);</span><br><span class="line">return num;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class HashMapDemo1 &#123;</span><br><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">Map&lt;Student , String&gt; tmap = new TreeMap&lt;Student , String&gt;();</span><br><span class="line">tmap.put(new Student(&quot;001&quot;,20), &quot;beijing&quot;);</span><br><span class="line">tmap.put(new Student(&quot;002&quot;,25), &quot;hebei&quot;);</span><br><span class="line">tmap.put(new Student(&quot;003&quot;,50), &quot;hainan&quot;);</span><br><span class="line">tmap.put(new Student(&quot;001&quot;,20), &quot;beijing&quot;);</span><br><span class="line">System.out.println(tmap.size());</span><br><span class="line">Set&lt;Student&gt; keySet1 = tmap.keySet();</span><br><span class="line">Iterator&lt;Student&gt; it1 = keySet1.iterator();</span><br><span class="line">while(it1.hasNext())&#123;</span><br><span class="line">Student stu = it1.next();</span><br><span class="line">String addr = tmap.get(stu);</span><br><span class="line">System.out.println(stu.getName()+&quot;..&quot;+stu.getAge()+&quot;::&quot;+addr);</span><br><span class="line">&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Iterator：对collection进行迭代的迭代器.迭代器取代了Enumeration。<br>迭代器和枚举的区别：<br>迭代器允许调用者利用定义良好的语义在迭代期间从迭代器所指向的collection移除元素<br>方法名称得到了改进，简化书写<br>LisIterator：系列表迭代器，允许程序员按任一方向遍历列表、迭代期间修改列表<br>Comparable：此接口强行对实现它的每个类的对象进行整体自然排序。使元素具备比较性<br>Comparator：强行对某个对象collection进行整体排序的比较函数，使集合具备比较性<br>Collections：此类完全由在 collection 上进行操作或返回 collection 的静态方法组成。<br>Arrays：此类包含用来操作数组(比如排序和搜索)的各种静态方法</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/20/关于字符串的陷阱/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qgx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qin12的学习博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/20/关于字符串的陷阱/" itemprop="url">
                  java 表达式中的陷阱
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-07-20 12:10:37" itemprop="dateCreated datePublished" datetime="2018-07-20T12:10:37+08:00">2018-07-20</time>
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="关于字符串的陷阱"><a href="#关于字符串的陷阱" class="headerlink" title="关于字符串的陷阱"></a>关于字符串的陷阱</h3><h4 id="JVM-对字符串的处理"><a href="#JVM-对字符串的处理" class="headerlink" title="JVM 对字符串的处理"></a>JVM 对字符串的处理</h4><p>String java = new String(“Java”) 这句创建了两个字符串对象，一个是 “Java” 这个直接量对应的字符串对象，另外一个是 new String() 构造器返回的字符串对象。<br><strong>Java 程序中创建对象的方法：</strong></p>
<ul>
<li>通过 new 调用构造器创建 Java 对象</li>
<li>通过 Class 对象的 newInstance() 方法调用构造器创建 Java 对象</li>
<li>通过 Java 的反序列化机制从 IO 流中恢复 Java 对象</li>
<li>通过 Java 对象提供的 clone() 方法复制一个新的 Java 对象<br>对于字符串以及 Byte、Short、Int、Long、Character、Float、Double 和 Boolean 这些基本类型的包装类<br>直接量的方式来创建 Java 对象 Integer in = 5；</li>
<li>通过简单的算法表达式，连接运算来创建 Java 对象 String str = “a” + “b”; （如果这个字符串表达式的值在编译时确定下来，那么 JVM 会在编译时计算该字符串变量的值，并让它指向字符串池中对应的字符串。如果这些算法表达式都是字符串直接量、整数直接量，没有变量和方法参与，那么就可以在编译期就可以确定字符串的值；如果使用了变量、调用了方法，那么只有等到运行时才能确定字符串表达式的值；如果字符串连接运算所有的变量都可执行 “宏替换”（使用 final 修饰的变量），那在编译时期也能确定字符串连接表达式的值）</li>
</ul>
<p>对于 Java 程序的字符直接量，JVM 会使用一个字符串池来保护它们；当第一次使用某个字符串直接量时，JVM 会将它放入字符串池进行缓存。在一般的情况下，字符串池中的字符串对象不会被垃圾回收器回收，当程序再次需要使用该字符串时，无需重新创建一个新的字符串，而是直接让引用变量指向字符串池中已有的字符串。</p>
<h4 id="不可变的字符串"><a href="#不可变的字符串" class="headerlink" title="不可变的字符串"></a>不可变的字符串</h4><ul>
<li>String 类是一个不可变类，当一个 String 对象创建完成后，该 String 类里包含的字符序列就被固定下来，以后永远不能修改。</li>
<li>如果程序需要一个字符序列会发生改变的字符串，那么建议使用 StringBuilder （效率比 StringBuffer 高）<h4 id="字符串比较"><a href="#字符串比较" class="headerlink" title="字符串比较"></a>字符串比较</h4></li>
<li><p>如果要比较两个字符串是否相同，用 == 进行判断就行，但如果要判断两个字符串所包含的字符序列是否相同，则应该用 String 重写过的 equals() 方法进行比较。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">public boolean equals(Object anObject) &#123;</span><br><span class="line">//如果两个字符串相同</span><br><span class="line">if (this == anObject) &#123;</span><br><span class="line">return true;</span><br><span class="line">&#125;</span><br><span class="line">//如果anObject是String类型</span><br><span class="line">if (anObject instanceof String) &#123;</span><br><span class="line">String anotherString = (String)anObject;</span><br><span class="line">//n代表字符串的长度</span><br><span class="line">int n = value.length;</span><br><span class="line">//如果两个字符串长度相等</span><br><span class="line">if (n == anotherString.value.length) &#123;</span><br><span class="line">//获取当前字符串、anotherString底层封装的字符数组</span><br><span class="line">char v1[] = value;</span><br><span class="line">char v2[] = anotherString.value;</span><br><span class="line">int i = 0;</span><br><span class="line">//逐一比较v1 和 v2数组中的每个字符</span><br><span class="line">while (n-- != 0) &#123;</span><br><span class="line">if (v1[i] != v2[i])</span><br><span class="line">return false;</span><br><span class="line">i++;</span><br><span class="line">&#125;</span><br><span class="line">return true;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>还可以使用 String 提供的 compareTo() 方法返回两个字符串的大小</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public int compareTo(String anotherString) &#123;</span><br><span class="line">int len1 = value.length;</span><br><span class="line">int len2 = anotherString.value.length;</span><br><span class="line">int lim = Math.min(len1, len2);</span><br><span class="line">char v1[] = value;</span><br><span class="line">char v2[] = anotherString.value;</span><br><span class="line"></span><br><span class="line">int k = 0;</span><br><span class="line">while (k &lt; lim) &#123;</span><br><span class="line">char c1 = v1[k];</span><br><span class="line">char c2 = v2[k];</span><br><span class="line">if (c1 != c2) &#123;</span><br><span class="line">return c1 - c2;</span><br><span class="line">&#125;</span><br><span class="line">k++;</span><br><span class="line">&#125;</span><br><span class="line">return len1 - len2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="表达式类型的陷阱"><a href="#表达式类型的陷阱" class="headerlink" title="表达式类型的陷阱"></a>表达式类型的陷阱</h3><h4 id="表达式类型的自动提升"><a href="#表达式类型的自动提升" class="headerlink" title="表达式类型的自动提升"></a>表达式类型的自动提升</h4><ul>
<li>所有 byte、short、char类型将被提升到 int 类型参与运算</li>
<li>整个算术表达式的数据类型自动提升到与表达式中最高等级操作数同样的类型，操作数的等级排列如下：char -&gt; int -&gt; long -&gt;float -&gt; double</li>
<li>byte -&gt; short -&gt; int -&gt; long -&gt;float -&gt; double<h4 id="复合赋值运算符的陷阱"><a href="#复合赋值运算符的陷阱" class="headerlink" title="复合赋值运算符的陷阱"></a>复合赋值运算符的陷阱</h4>Java 语言允许所有的双目运算符和 = 一起结合组成复合赋值运算符，如 +=、-=、*=、/=、%= 、&amp;= 等，复合赋值运算符包含了一个隐式的类型转换。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//下面这两条语句不等价</span><br><span class="line">a = a + 5; //</span><br><span class="line">a += 5; //实际上等价于 a = (a的类型) (a + 5);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>复合赋值运算符会自动的将它计算的结果值强制转换为其左侧变量的类型。</p>
<h3 id="输入法导致的陷阱"><a href="#输入法导致的陷阱" class="headerlink" title="输入法导致的陷阱"></a>输入法导致的陷阱</h3><h3 id="注释的字符必须合法"><a href="#注释的字符必须合法" class="headerlink" title="注释的字符必须合法"></a>注释的字符必须合法</h3><h3 id="转义字符的陷阱"><a href="#转义字符的陷阱" class="headerlink" title="转义字符的陷阱"></a>转义字符的陷阱</h3><ul>
<li>慎用字符的 Unicode 转义形式</li>
<li>中止行注释的转义字符<h3 id="泛型可能引起的错误"><a href="#泛型可能引起的错误" class="headerlink" title="泛型可能引起的错误"></a>泛型可能引起的错误</h3><h4 id="原始类型变量的赋值"><a href="#原始类型变量的赋值" class="headerlink" title="原始类型变量的赋值"></a>原始类型变量的赋值</h4></li>
<li>当程序把一个原始类型的变量赋给一个带有泛型信息的变量时，总是可以通过编译（只是会提示警告信息）</li>
<li>当程序试图访问带泛型声明的集合的集合元素时，编译器总是把集合元素 当成泛型类型处理（它并不关心集合里集合元素的实际类型）</li>
<li>当程序试图访问带泛型声明的集合的集合元素时，JVM会遍历每个集合元素自动执行强制转型，如果集合元素的实际类型与集合所带的泛型信息不匹配，运行时将引发 ClassCastException<h4 id="原始类型带来的擦除"><a href="#原始类型带来的擦除" class="headerlink" title="原始类型带来的擦除"></a>原始类型带来的擦除</h4>当把一个具有泛型信息的对象赋给另一个没有泛型信息的变量时，所有在尖括号之间的类型信息都会丢弃。<h4 id="创建泛型数组的陷阱"><a href="#创建泛型数组的陷阱" class="headerlink" title="创建泛型数组的陷阱"></a>创建泛型数组的陷阱</h4>Java 中不允许创建泛型数组<h4 id="正则表达式的陷阱"><a href="#正则表达式的陷阱" class="headerlink" title="正则表达式的陷阱"></a>正则表达式的陷阱</h4>有些符号本身就是正则表达式，我们需要对符号做转义运算。<h3 id="多线程的陷阱"><a href="#多线程的陷阱" class="headerlink" title="多线程的陷阱"></a>多线程的陷阱</h3><h4 id="不要调用-run-方法"><a href="#不要调用-run-方法" class="headerlink" title="不要调用 run 方法"></a>不要调用 run 方法</h4>开启线程是用 start() 方法，而不是 run() 方法。<h4 id="静态的同步方法"><a href="#静态的同步方法" class="headerlink" title="静态的同步方法"></a>静态的同步方法</h4>对于同步代码块而言，程序必须显式为它指定同步监视器；对于同步非静态方法而言，该方法的同步监视器是 this —— 即调用该方法的 Java 对象；对于静态的同步方法而言，该方法的同步监视器不是 this，而是该类本身。</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/20/ListView 和 Adapter数据适配器简单介绍/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qgx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qin12的学习博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/20/ListView 和 Adapter数据适配器简单介绍/" itemprop="url">
                  Android 编程知识
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-07-20 12:10:37" itemprop="dateCreated datePublished" datetime="2018-07-20T12:10:37+08:00">2018-07-20</time>
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Android/" itemprop="url" rel="index"><span itemprop="name">Android</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="ListView-和-Adapter数据适配器简单介绍"><a href="#ListView-和-Adapter数据适配器简单介绍" class="headerlink" title="ListView 和 Adapter数据适配器简单介绍"></a>ListView 和 Adapter数据适配器简单介绍</h3><h4 id="ListView"><a href="#ListView" class="headerlink" title="ListView"></a>ListView</h4><ul>
<li>显示大量的相同格式数据</li>
<li>常用属性：<ul>
<li>listSelector  listView每项在选中、按下等不同状态时的Drawable</li>
<li>divider                ListView每项间的间隔Drawable</li>
<li>dividerHeight        ListView每项间间隔的间隔高度</li>
</ul>
</li>
<li>常用方法<ul>
<li>setAdapter()                设置数据适配器</li>
<li>setOnItemClickListener()        设置每项点击事件监听</li>
<li>addHeaderView()            添加头视图</li>
<li>addFooterView()            添加脚视图</li>
<li>setEmptyView()                设置数据项为0时的空数据视图<h4 id="Adapter数据适配器"><a href="#Adapter数据适配器" class="headerlink" title="Adapter数据适配器"></a>Adapter数据适配器</h4>将各种数据以合适的形式绑定到控件上<br>像listview, gridview, spinner 等等等控件 都会用到Adapter绑定数据</li>
<li>三种Adapter</li>
<li>ArrayAdapter：支持泛型操作，最简单的一个Adapter，只能展现一行文字</li>
<li>SimpleAdapter：同样具有良好扩展性的一个Adapter，可以自定义多种效果</li>
<li>BaseAdapter：抽象类，实际开发中我们会继承这个类并且重写相关方法，用得最多的一个Adapter<h5 id="ArrayAdapt"><a href="#ArrayAdapt" class="headerlink" title="ArrayAdapt"></a>ArrayAdapt</h5>参数1：当前上下文环境<br>参数2：android.R.layout.simple_list_item_1<br>　　　　是android自带的一个简单布局 里面只包含一个id为text1的TextView  也就是参数3    ArrayAdapter只能显示一行数据 显示文本信息 使用这个系统提供的布局就可以<br>android系统还给我们提供了其他一些好用的模板<br>　　simple_list_item_1 : 单独一行的文本框<br>　　simple_list_item_2 : 两个文本框组成<br>　　simple_list_item_checked : 每项都是由一个已选中的列表项<br>　　imple_list_item_multiple_choice : 都带有一个复选框<br>　　simple_list_item_single_choice : 都带有一个单选钮<br>参数4：绑定的数据 这里使用是string数组       上面提到过ArrayAdapter支持泛型 也可以绑定一个list显示效果绑定了listview<h5 id="SimpleAdapter"><a href="#SimpleAdapter" class="headerlink" title="SimpleAdapter"></a>SimpleAdapter</h5>　simpleAdapter的扩展性最好，可以定义各种各样的布局出来，可以放上ImageView（图片），还可以放上Button（按钮），CheckBox（复选框）等等<h5 id="BaseAdapter"><a href="#BaseAdapter" class="headerlink" title="BaseAdapter"></a>BaseAdapter</h5></li>
</ul>
</li>
<li>BaseAdapter是开发中最常用的适配器ArrayAdapter, SimpleAdapter 都继承于BaseAdapter。BaseAdapter可以完成自己定义的Adapter，可以将任何复杂组合的数据和资源，以任何你想要的显示效果展示给大家。</li>
<li>继承BaseAdapter之后，需要重写以下四个方法：getCount，getItem，getItemId，getView。</li>
<li>系统在绘制ListView之前，将会先调用getCount方法来获取Item的个数。每绘制一个Item就会调用一次getView方法，在getView中引用事先定义好的layout布局确定显示的效果并返回一个View对象作为一个Item显示出来。</li>
<li>这两个方法是自定ListView显示效果中最为重要的，同时只要重写好了这两个方法，ListView就能完全按开发者的要求显示。而getItem和getItemId方法将会在调用ListView的响应方法的时候被调用到。</li>
<li>自定义布局文件（listview的项的显示效果）<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    android:orientation=&quot;vertical&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line">    &lt;LinearLayout</span><br><span class="line">        android:id=&quot;@+id/title&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:gravity=&quot;center_vertical&quot;</span><br><span class="line">        android:orientation=&quot;horizontal&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:id=&quot;@+id/et_id2&quot;</span><br><span class="line">            android:layout_width=&quot;0dp&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_weight=&quot;0.8&quot;</span><br><span class="line">            android:hint=&quot;id&quot;</span><br><span class="line">            android:inputType=&quot;none&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:id=&quot;@+id/et_name2&quot;</span><br><span class="line">            android:layout_width=&quot;0dp&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_weight=&quot;1.5&quot;</span><br><span class="line">            android:hint=&quot;姓名&quot;</span><br><span class="line">            android:maxLength=&quot;4&quot;</span><br><span class="line">            android:maxLines=&quot;1&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:id=&quot;@+id/et_author2&quot;</span><br><span class="line">            android:layout_width=&quot;0dp&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_weight=&quot;1&quot;</span><br><span class="line">            android:hint=&quot;作者&quot;</span><br><span class="line">            android:maxLength=&quot;1&quot;</span><br><span class="line">            android:maxLines=&quot;1&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:id=&quot;@+id/et_pages2&quot;</span><br><span class="line">            android:layout_width=&quot;0dp&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_weight=&quot;1&quot;</span><br><span class="line">            android:hint=&quot;页数&quot;</span><br><span class="line">            android:inputType=&quot;number&quot;</span><br><span class="line">            android:maxLength=&quot;3&quot;</span><br><span class="line">            android:maxLines=&quot;1&quot; /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:id=&quot;@+id/et_price2&quot;</span><br><span class="line">            android:layout_width=&quot;0dp&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:layout_weight=&quot;1&quot;</span><br><span class="line">            android:hint=&quot;价格&quot;</span><br><span class="line">            android:inputType=&quot;number&quot;</span><br><span class="line">            android:maxLength=&quot;3&quot;</span><br><span class="line">            android:maxLines=&quot;1&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/LinearLayout&gt;</span><br><span class="line">&lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>Book类<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">public class Book extends DataSupport &#123;</span><br><span class="line">    private  int id;</span><br><span class="line">    private String name;</span><br><span class="line">    private String author;</span><br><span class="line">    private int pages;</span><br><span class="line">    private double price;</span><br><span class="line"></span><br><span class="line">    public int getId() &#123;</span><br><span class="line">        return id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setId(int id) &#123;</span><br><span class="line">        this.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setName(String name) &#123;</span><br><span class="line">        this.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getAuthor() &#123;</span><br><span class="line">        return author;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setAuthor(String author) &#123;</span><br><span class="line">        this.author = author;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public int getPages() &#123;</span><br><span class="line">        return pages;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setPages(int pages) &#123;</span><br><span class="line">        this.pages = pages;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public double getPrice() &#123;</span><br><span class="line">        return price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setPrice(double price) &#123;</span><br><span class="line">        this.price = price;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>MainActivity<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">ublic class MainActivity extends AppCompatActivity &#123;</span><br><span class="line">    private Button create_database = null;</span><br><span class="line">    private Button add_data = null;</span><br><span class="line">    private Button detele_data = null;</span><br><span class="line">    private Button update_data = null;</span><br><span class="line">    private Button query_data = null;</span><br><span class="line">    private LinearLayout title = null;</span><br><span class="line">    private ListView listViewcontent =null;</span><br><span class="line">    private EditText et_id = null;</span><br><span class="line">    private EditText et_name = null;</span><br><span class="line">    private EditText et_author = null;</span><br><span class="line">    private EditText et_pages = null;</span><br><span class="line">    private EditText et_price = null;</span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        findViewById();</span><br><span class="line">        listener();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">private void listener()&#123;</span><br><span class="line">    create_database.setOnClickListener(</span><br><span class="line">            new View.OnClickListener() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                public void onClick(View view) &#123;</span><br><span class="line">                    Connector.getDatabase();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    );</span><br><span class="line">    add_data.setOnClickListener(</span><br><span class="line">            new View.OnClickListener() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                public void onClick(View view) &#123;</span><br><span class="line">                    Book book = new Book();</span><br><span class="line">                    book.setName(et_name.getText().toString().trim());</span><br><span class="line">                    book.setAuthor(et_author.getText().toString().trim());</span><br><span class="line">                    book.setPages(Integer.parseInt(et_pages.getText().toString().trim()));</span><br><span class="line">                    book.setPrice(Integer.parseInt(et_price.getText().toString().trim()));</span><br><span class="line">                    book.save();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    );</span><br><span class="line">    detele_data.setOnClickListener(</span><br><span class="line">            new View.OnClickListener() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                public void onClick(View view) &#123;</span><br><span class="line">                    DataSupport.deleteAll(Book.class, &quot;name = ?&quot;, et_name.getText().toString().trim());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    );</span><br><span class="line">    update_data.setOnClickListener(</span><br><span class="line">            new View.OnClickListener() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                public void onClick(View view) &#123;</span><br><span class="line">                    Book book = new Book();</span><br><span class="line">                    book.setPrice(Double.parseDouble(et_price.getText().toString().trim()));</span><br><span class="line">                    book.updateAll(&quot;name = ? and author = ?&quot;, et_name.getText().toString().trim(),et_author.toString().trim());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    );</span><br><span class="line">    query_data.setOnClickListener(</span><br><span class="line">            new View.OnClickListener() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                public void onClick(View view) &#123;</span><br><span class="line">                    List&lt;Book&gt; books = DataSupport.findAll(Book.class);</span><br><span class="line">                    Log.d(&quot;qgx&quot;, &quot;onClick: &quot;+books.toString());</span><br><span class="line">                listViewcontent.setAdapter(</span><br><span class="line">            new MyAdapter(books,MainActivity.this));</span><br><span class="line">                    for (Book book : books) &#123;</span><br><span class="line">                        Log.d(&quot;MainActivity&quot;, &quot;book name is&quot; + book.getName());</span><br><span class="line">                        Log.d(&quot;MainActivity&quot;, &quot;book author is&quot; + book.getAuthor());</span><br><span class="line">                        Log.d(&quot;MainActivity&quot;, &quot;book pages is&quot; + book.getPages());</span><br><span class="line">                        Log.d(&quot;MainActivity&quot;, &quot;book price is&quot; + book.getPrice());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line">    //关联控件</span><br><span class="line">    private void findViewById() &#123;</span><br><span class="line">        create_database = (Button) findViewById(R.id.create_database);</span><br><span class="line">        add_data = (Button)  findViewById(R.id.add_data);</span><br><span class="line">        update_data =  (Button) findViewById(R.id.update_data);</span><br><span class="line">        query_data = (Button)  findViewById(R.id.query_data);</span><br><span class="line">        detele_data =  (Button) findViewById(R.id.detele_data);</span><br><span class="line">        et_id =(EditText) findViewById(R.id.et_id);</span><br><span class="line">        et_name =(EditText) findViewById(R.id.et_name);</span><br><span class="line">        et_author =(EditText) findViewById(R.id.et_author);</span><br><span class="line">        et_pages =(EditText) findViewById(R.id.et_pages);</span><br><span class="line">        et_price =(EditText) findViewById(R.id.et_price);</span><br><span class="line">        title = (LinearLayout) findViewById(R.id.title);</span><br><span class="line">        listViewcontent =(ListView) findViewById(R.id.content);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>MyAdapter<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">public class MyAdapter  extends BaseAdapter&#123;</span><br><span class="line">    private List&lt;Book&gt; books;</span><br><span class="line">    private LayoutInflater inflater;</span><br><span class="line">    public MyAdapter(List&lt;Book&gt; books,Context context) &#123;</span><br><span class="line">        this.books = books;</span><br><span class="line">        this.inflater=LayoutInflater.from(context);</span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public int getCount() &#123;</span><br><span class="line">        return books==null?0:books.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Object getItem(int i) &#123;</span><br><span class="line">        return books.get(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public long getItemId(int i) &#123;</span><br><span class="line">        return i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public View getView(int i, View view, ViewGroup viewGroup) &#123;</span><br><span class="line">        //加载布局为一个视图</span><br><span class="line">       view=inflater.inflate(R.layout.item_book,null);</span><br><span class="line">       Book book = (Book)getItem(i) ;</span><br><span class="line">        TextView et_id2 = view.findViewById(R.id.et_id2);</span><br><span class="line">        TextView et_name2 = view.findViewById(R.id.et_name2);</span><br><span class="line">        TextView et_author2 = view.findViewById(R.id.et_author2);</span><br><span class="line">        TextView et_pages2 = view.findViewById(R.id.et_pages2);</span><br><span class="line">        TextView et_price2 = view.findViewById(R.id.et_price2);</span><br><span class="line">       et_id2.setText(book.getId()+&quot;&quot;);</span><br><span class="line">       et_author2.setText(book.getAuthor());</span><br><span class="line">       et_name2.setText(book.getName());</span><br><span class="line">       et_pages2.setText(book.getPages()+&quot;&quot;);</span><br><span class="line">       et_price2.setText(book.getPrice()+&quot;&quot;);</span><br><span class="line">        return view;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/20/java的内存回收/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Qgx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="qin12的学习博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/20/java的内存回收/" itemprop="url">
                  java 基础知识(四)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-07-20 12:10:37" itemprop="dateCreated datePublished" datetime="2018-07-20T12:10:37+08:00">2018-07-20</time>
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="java的内存回收"><a href="#java的内存回收" class="headerlink" title="java的内存回收"></a>java的内存回收</h2><h3 id="Java-引用的种类"><a href="#Java-引用的种类" class="headerlink" title="Java 引用的种类"></a>Java 引用的种类</h3><p>   JVM 垃圾回收机制，是否回收一个对象的标准在于：是否还有引用变量引用该对象？只要有引用变量引用该对象，垃圾回收机制就不会回收它。<br>Java 语言对对象的引用有：</p>
<ul>
<li>强引用</li>
<li>软引用</li>
<li>弱引用</li>
<li><p>虚引用</p>
<ul>
<li>强引用：程序创建一个对象，并把这个对象赋给一个引用变量，这个引用变量就是强引用。当一个对象被一个或者一个以上的强引用变量所引用时，它处于可达状态，它是不会被系统的垃圾回收机制回收。软引用</li>
<li>软引用：需要通过 SoftReference 类来实现，当一个对象只具有软引用时，它有可能会被垃圾回收机制回收。对于只有软引用的对象而言，当系统内存空间足够时，它不会被系统回收，程序也可使用该对象；当系统内存空间不足时，系统将会回收它。</li>
<li>弱引用：和软引用有点相似，区别在于弱引用所引用对象的生存期更短。</li>
<li>虚引用：主要用于跟踪对象被垃圾回收的状态，虚引用不能单独使用，虚引用必须和引用队列联合使用。</li>
</ul>
</li>
</ul>
<h3 id="Java-的内存泄漏"><a href="#Java-的内存泄漏" class="headerlink" title="Java 的内存泄漏"></a>Java 的内存泄漏</h3><p>ArrayList.java 中的 remove 方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public E remove(int index) &#123;</span><br><span class="line">rangeCheck(index);</span><br><span class="line">modCount++;</span><br><span class="line">E oldValue = elementData(index);</span><br><span class="line">int numMoved = size - index - 1;</span><br><span class="line">if (numMoved &gt; 0)</span><br><span class="line">System.arraycopy(elementData, index+1, elementData, index,</span><br><span class="line">numMoved);</span><br><span class="line">elementData[--size] = null; // clear to let GC do its work</span><br><span class="line">return oldValue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>其中 elementData[–size] = null; // clear to let GC do its work 语句是清除数组元素的引用，避免内存的泄漏，如果没有这句的话，那么就是只有两个作用：<br>修饰 Stack 的属性，也就是将值减 1；<br>返回索引为 size -1 的值。</p>
<h3 id="垃圾回收机制"><a href="#垃圾回收机制" class="headerlink" title="垃圾回收机制"></a>垃圾回收机制</h3><ul>
<li>跟踪并监控每个 Java 对象，当某个对象处于不可达状态时，回收该对象所占用的内存。</li>
<li>清理内存分配，回收过程中产生的内存碎片。<h4 id="垃圾回收机制的基本算法"><a href="#垃圾回收机制的基本算法" class="headerlink" title="垃圾回收机制的基本算法"></a>垃圾回收机制的基本算法</h4>对于一个垃圾回收器的设计算法来说，大概有如下几个设计：     </li>
<li><p>串行回收 和 并行回收</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">串行回收：不管系统有多少个 CPU，始终使用一个 CPU 来执行垃圾回收操作</span><br><span class="line">并行回收：把整个回收工作拆分成多部分，每个部分由一个 CPU 负责，从而让多个 CPU 并行回收</span><br></pre></td></tr></table></figure>
</li>
<li><p>并发执行 和 应用程序停止</p>
</li>
<li>压缩 和 不压缩 和 复制<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">   复制：将堆内分成两个相同的空间，从根开始访问每一个关联的可达对象，将空间A的可达对象全部复制到空间B，然后一次性回收整个空间A。</span><br><span class="line">标记清除：也就是 不压缩 的回收方式。垃圾回收器先从根开始访问所有可达对象，将它们标记为可达状态，然后再遍历一次整个内存区域，把所有没有标记为可达的对象进行回收处理。</span><br><span class="line">   标记压缩：这是压缩方式，这种方式充分利用上述两种算法的优点，垃圾回收器先从根开始访问所有可达对象，将他们标记为可达状态，接下来垃圾回收器会将这些活动对象搬迁在一起，这个过程叫做内存压缩，然后垃圾回收机制再次回收那些不可达对象所占用的内存空间，这样就避免了回收产生的内存碎片。</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="堆内存的分代回收"><a href="#堆内存的分代回收" class="headerlink" title="堆内存的分代回收"></a>堆内存的分代回收</h4><ul>
<li>Young 代</li>
<li>Old 代</li>
<li>Permanent 代<h3 id="内存管理小技巧"><a href="#内存管理小技巧" class="headerlink" title="内存管理小技巧"></a>内存管理小技巧</h3></li>
<li>尽量使用直接量</li>
<li>使用 StringBuilder 和 StringBuffer 进行字符串拼接</li>
<li>尽早释放无用对象的引用</li>
<li>尽量少用静态变量</li>
<li>避免在经常调用的方法、循环中创建 Java 对象</li>
<li>缓存经常使用的对象</li>
<li>尽量不要使用 finalize 方法</li>
<li>考虑使用 SoftReference</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.gif"
                alt="Qgx" />
            
              <p class="site-author-name" itemprop="name">Qgx</p>
              <p class="site-description motion-element" itemprop="description">漫漫长路，伴你同行</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">89</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">9</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">63</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/qin12" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:1520290900@qq.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="tencent://AddContact/?fromId=45&fromSubId=1&subcmd=all&uin=1520290900&website=www.oicqzone.com" target="_blank" title="QQ"><i class="fa fa-fw fa-QQ"></i>QQ</a>
                  
                </span>
              
            </div>
          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-[object Object]"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Qgx</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v</div>




        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv" title="总访客量">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="site-pv" title="总访问量">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>














  













  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.2.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.2.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.2.0"></script>



  



	





  





  










  





  

  

  

  

  
  

  

  

  

  

  

  <script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
</body>
</html>
